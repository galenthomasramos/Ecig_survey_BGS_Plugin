    <!DOCTYPE html>
    <html>
    <head>

        <!-- UPDATED FROM WITHOUT assets/www/...-->

        <meta charset="UTF-8">
        <meta name="format-detection" content="telephone-no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, minimum-scale=1, maximum-scale=1, width=device-width, height=device-height">
        <title>Our Application</title>
        <!--link rel="stylesheet" href="css/themes/default/jquery.mobile-1.2.0.css" /-->
        <!--link rel="stylesheet" href="css/redmond/jquery-ui-1.10.3.custom.css" /-->
        <!--link rel="stylesheet" href="js/jquery.mobile-1.3.2.css" /-->
        <link rel="stylesheet" href="css/main.css" />
        <link rel="stylesheet" href="css/themes/ecig/ecig_themes.css" />
        <link rel="stylesheet" href="js/jquery.mobile.structure-1.3.2.css" />
        <script src="cordova.js"></script>
        <!--script src="cordova_plugins.js"></script-->

        <script src="js/jquery-1.10.2.js"></script>
        <!--  script src="http://code.jquery.com/jquery-migrate-1.2.1.js"></script-->

        <script src="js/jquery.mobile-1.3.2.js"></script>
        <!--script src="js/jquery-ui-1.10.3.custom.js"></script-->
        <!--script src="js/jquery.ui.touch-punch.js"></script-->

        <script src="js/mustache.js"></script>
        <script src="js/index.js">app.initialize()</script>
        <script src="js/date.js"></script>
        <script src="js/moment.js"></script>

        <script src="js/caesar_cipher.js"></script>

        <!--script src="js/cryptojs/aes.js"></script-->
        <!--script src="js/cryptojs/aes_302.js"></script-->

        <script src="mobiscroll/js/mobiscroll.core.js"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.js" type="text/javascript"></script>

        <script src="mobiscroll/js/mobiscroll.datetime.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.select.js" type="text/javascript"></script>

        <script src="mobiscroll/js/mobiscroll.scroller.jqm.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.ios.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.android.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.android-ics.js" type="text/javascript"></script>
        <script src="mobiscroll/js/mobiscroll.scroller.wp.js" type="text/javascript"></script>

        <script src="mobiscroll/js/i18n/mobiscroll.i18n.de.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.es.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.fr.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.hu.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.it.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.no.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.pt-BR.js" type="text/javascript"></script>
        <script src="mobiscroll/js/i18n/mobiscroll.i18n.zh.js" type="text/javascript"></script>

        <link href="mobiscroll/css/mobiscroll.scroller.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.jqm.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.android.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.android-ics.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.ios.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.sense-ui.css" rel="stylesheet" type="text/css" />
        <link href="mobiscroll/css/mobiscroll.scroller.wp.css" rel="stylesheet" type="text/css" />

        <link href="mobiscroll/css/mobiscroll.animation.css" rel="stylesheet" type="text/css" />

        <script>

        var encryptionKey = 'unobtainium45459';
        var adminPin = '45459';

        //var notificationSoundLoc = 'www/audio/notificationsound1.mp3';
        //var notificationSoundLoc = 'android.resource://com.testing.ecigcordova3_3/raw/notificationsound1.mp3';

        var eCigService;

        var TobaccoUseIntFileWriter;
        var randomPromptIntFileWriter;
        var suspendFileWriter;
        var wakeTimeBedTimeFileWriter;
        var notificationFileWriter;
        var missedNotificationsFileWriter;
        var loginFileWriter;

        var TobaccoUseIntFileString;
        var randomPromptIntFileString;
        var suspendFileString;
        var bedTimeFileString;
        var wakeTimeFileString;
        var notificationFileString;
        var loginFileString;

        var delimiter = ', ';

        var writingToLoginInfo = false;
        var writingToNotificationTimes = false;
        var writingToTobaccoUseInt = false;
        var writingToRandomPromptInt = false;
        var writingToBedtime = false;
        var writingToSuspendTime = false;

        //var minSleepTime = 4;
        //var maxSleepTime = 19;

        var minSleepTime = 4;
        var maxSleepTime = 19;

        var didMissNotificationArr = [];
        var didMissDelayedNotification = true;
        var didMissWakeUp = true;

        var userID = 'USERID_X';

        var date = new Date();
        var hour, min, sec;
        var timeStamp;

        var bufferMins = 15;
        //var bufferMins = 2;

        //var surveysInADay = 50 ;
        var surveysInADay = 7;

        var my_media = null;
        var my_alarm_media = null;

        var hasMissedNotification = false;
        var missedNotifications = 0;

        var notificationCount = 0;

        var partitionTimes = [];
        var notificationTimes = [];

        var takingTestSurvey = false;

        var startedRandomPromptSurvey = false;
        var finishedRandomPromptSurvey = false;

        var defaultWakeTime = moment().hours(0).minutes(0).seconds(0);
        var defaultBedTime = moment().hours(23).minutes(59).seconds(0);

        //variables used to determine notification beginning and end times:
        var wakeTimeDate = moment(defaultWakeTime);
        var bedTimeDate = moment(defaultBedTime);
        var timeAsleep = 1;
        var timeAwake = Math.abs(timeAsleep - (24 * 60));

        var states = {
            ACTIVE:      0,
            ASLEEP:      1,
            DELAYED:     2,
            SUSPENDED:   3
        };

        var wakeUpFiring = false;

        var currentState = states.ACTIVE;

        var resumeTime = null;//holds time value at which the application will return to a normal state... after being delayed, suspended, or asleep for so long.

        //console.log("wakeTime: " + wakeTimeDate.format());
        //console.log("bedTime: " + bedTimeDate.format());

        var goto5a = false;
        var goto5a1 = false;
        var gotoCigMenthol = false;

        var surveyString = "";

        var config = {
            "didMissNotificationArr":        didMissNotificationArr,
            "notificationTimes":             notificationTimes,
            "notificationCount":             notificationCount,
            "currentState":                  currentState,
            "startedRandomPromptSurvey":     startedRandomPromptSurvey,
            "finishedRandomPromptSurvey":    finishedRandomPromptSurvey,
            "missedNotifications":           missedNotifications,
            "hasMissedNotification":         hasMissedNotification,
            "didMissDelayedNotification":    didMissDelayedNotification,
            "didMissWakeUp":                 didMissWakeUp,
            "surveysInADay":                 surveysInADay,
            "userID":                        userID,
            "timeAsleep":                    timeAsleep,
            "timeAwake":                     timeAwake,
            "wakeUpFiring":                  wakeUpFiring,
            "resumeTime":                    resumeTime,
            "wakeTimeDate":                  wakeTimeDate,
            "bedTimeDate":                   bedTimeDate
        };

        var delayData = {delaymins:""};
        var delayTemplate = '<h3>Do you want to do the survey now or delay it?</h3>\
                             <a href="#" data-role="button" data-icon="bars" onclick="startRandomPromptInterview()">Do the survey now</a>\
                             <div id="delaydiv" data-role="controlgroup" data-type="horizontal">\
                                    <label for="select-choice-1">Select a delay amount:</label>\
                                	<select name="select-choice-1" id="select-choice-1" data-icon="arrow-d" data-iconpos="left">\
                                        <option value="5">5 mins</option>\
                                        <option value="10">10 mins</option>\
                                        <option value="15">15 mins</option>\
                                        <option value="20">20 mins</option>\
                                    </select>\
                                    <a href="#" data-role="button" data-icon="check" onclick="delayNotification(false)">Delay notification</a>\
                             </div>';

        var visitedEmoSurveyA = false;
        var visitedEmoSurveyB = false;
        var visitedEmoSurveyC = false;

        var emoSurveyAData = {happy:"",relax:"",cheer:""};
        var emoSurveyATemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="jqmslidercontemoSurveyA">\
                                        <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-happy" class="sliderlabel">Happy:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-happy" id="slider-happy" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-relax" class="sliderlabel">Relaxed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-relax" id="slider-relax" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-cheer" class="sliderlabel">Cheerful:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-cheer" id="slider-cheer" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    </div>';


        var emoSurveyBData = {sad:"",stress:"",angry:""};
        var emoSurveyBTemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="jqmslidercontemoSurveyB">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-sad" class="sliderlabel">Sad:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-sad" id="slider-sad" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-stress" class="sliderlabel">Stressed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-stress" id="slider-stress" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-angry" class="sliderlabel">Angry:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-angry" id="slider-angry" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    </div>';


        var emoSurveyCData = {frust:"",irritbl:"",confdnt:""};
        var emoSurveyCTemplate =  '<h3>On a scale of 1-10</h3>\
                                    <h2>Right now, I feel:</h2>\
                                    <div class="jqmslidercontemoSurveyC">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-frust" class="sliderlabel">Frustrated:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-frust" id="slider-frust" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-irritbl" class="sliderlabel">Irritable:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-irritbl" id="slider-irritbl" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-confdnt" class="sliderlabel">Confident:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-confdnt" id="slider-confdnt" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    </div>';

        var visitedBeforeTobEmoSurveyA = false;
        var visitedBeforeTobEmoSurveyB = false;
        var visitedBeforeTobEmoSurveyC = false;

        var beforeTobEmoSurveyAData = {bhappy:"",brelax:"",bcheer:""};
        var beforeTobEmoSurveyATemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="jqmslidercontemoSurveyA">\
                                        <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bhappy" class="sliderlabel">Happy:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bhappy" id="slider-bhappy" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-brelax" class="sliderlabel">Relaxed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-brelax" id="slider-brelax" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                        \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bcheer" class="sliderlabel">Cheerful:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bcheer" id="slider-bcheer" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    </div>';


        var beforeTobEmoSurveyBData = {bsad:"",bstress:"",bangry:""};
        var beforeTobEmoSurveyBTemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="jqmslidercontemoSurveyB">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bsad" class="sliderlabel">Sad:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bsad" id="slider-bsad" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bstress" class="sliderlabel">Stressed:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bstress" id="slider-bstress" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bangry" class="sliderlabel">Angry:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bangry" id="slider-bangry" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                </div>';


        var beforeTobEmoSurveyCData = {bfrust:"",birritbl:"",bconfdnt:""};
        var beforeTobEmoSurveyCTemplate =  '<h3>Now think about the time <span style=”text-decoration:underline;”>just before</span> you used tobacco...</h3>\
                                    <h3>On a scale of 1-10</h3>\
                                    <h2>Before using tobacco, I felt:</h2>\
                                    <div class="jqmslidercontemoSurveyC">\
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bfrust" class="sliderlabel">Frustrated:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bfrust" id="slider-bfrust" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-birritbl" class="sliderlabel">Irritable:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-birritbl" id="slider-birritbl" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    \
                                         <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                            <label for="slider-bconfdnt" class="sliderlabel">Confident:</label>\
                                            <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                            <input type="range" name="slider-bconfdnt" id="slider-bconfdnt" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                        </div>\
                                    </div>';

        var visitedWhenUsingTobSurvey = false;

        //Need to replace # with answer from previous question
        var whenUsingTobSurveyData = {pleasur:"",satisfy:""};
        var whenUsingTobSurveyTemplate = '<h3>Now think about when you were using tobacco...</h3>\
                                            <h3>On a scale of 1-10</h3>\
                                            <div class="jqmslidercontemoSurveyA">\
                                                <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                                    <label for="slider-pleasur" class="sliderlabel" id="pleasurLabel">How pleasurable was the product?</label>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="range" name="slider-pleasur" id="slider-pleasur" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                                </div>\
                                                \
                                                 <div data-role="fieldcontain" class="jquerymobileslidercont">\
                                                    <label for="slider-satisfy" class="sliderlabel" id="satisfyLabel">How satisfying was the product?</label>\
                                                    <div><span class="leftSpan">Not at all</span><span  class="rightSpan">Very much</span></div>\
                                                    <input type="range" name="slider-satisfy" id="slider-satisfy" value="" min="1" max="10" step="1" class="jquerymobileslider" data-highlight="true" data-show-value="true" data-popup-enabled="true">\
                                                </div>\
                                                \
                                            </div>';

		var productUrgeSurveyData = {ulcigar:"", ucigarilo:"", ubcigar:"", uecig:"", uvap:"", uhookah:"", uchew:"", udipsnf:"", usnus:"", unourge:""};
        var productUrgeSurveyTemplate= '<h3>Right now: Do you have an urge to have/use any of the following tobacco products (check all that apply)?</h3>\
                                       <div id="productUrgeSurveyCheckboxes" data-role="fieldcontain">\
                                           <fieldset class="ui-grid-a">\
                                           \
                                                <div class="ui-block-a">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="checkbox" name="checkbox-ulcigar" id="checkbox-ulcigar" class="check" />\
                                                        <label for="checkbox-ulcigar">Little Cigar</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-ucigarilo" id="checkbox-ucigarilo" class="check" />\
                                                        <label for="checkbox-ucigarilo">Cigarillo</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-ubcigar" id="checkbox-ubcigar" class="check" />\
                                                        <label for="checkbox-ubcigar">Big Cigar</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-uecig" id="checkbox-uecig" class="check" />\
                                                        <label for="checkbox-uecig">e-cigarette</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-uvap" id="checkbox-uvap" class="check" />\
                                                        <label for="checkbox-uvap">Vaporizer</label>\
                                                    </fieldset>\
                                                </div>\
                                                \
                                                <div class="ui-block-b">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="checkbox" name="checkbox-uhookah" id="checkbox-uhookah" class="check" />\
                                                        <label for="checkbox-uhookah">Hookah</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-uchew" id="checkbox-uchew" class="check" />\
                                                        <label for="checkbox-uchew">Chew</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-udipsnf" id="checkbox-udipsnf" class="check" />\
                                                        <label for="checkbox-udipsnf">Dip or Snuff</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-usnus" id="checkbox-usnus" class="check" />\
                                                        <label for="checkbox-usnus">Snus</label>\
                                                        \
                                                        <input type="checkbox" name="checkbox-unourge" id="checkbox-unourge" class="check" />\
                                                        <label for="checkbox-unourge">No urge for any tobacco product</label>\
                                                    </fieldset>\
                                                </div>\
                                            </fieldset>\
                                        </div>';
/*
 var productUrgeSurveyTemplate= '<h3>Right now: Do you have an urge to have/use any of the following tobacco products (check all that apply)?</h3>\
 <div data-role="fieldcontain">\
 <fieldset data-role="controlgroup">\
 <input type="checkbox" name="checkbox-ulcigar" id="checkbox-ulcigar" class="check" />\
 <label for="checkbox-ulcigar">Little Cigar</label>\
 \
 <input type="checkbox" name="checkbox-ucigarilo" id="checkbox-ucigarilo" class="check" />\
 <label for="checkbox-ucigarilo">Cigarillo</label>\
 \
 <input type="checkbox" name="checkbox-ubcigar" id="checkbox-ubcigar" class="check" />\
 <label for="checkbox-ubcigar">Big Cigar</label>\
 \
 <input type="checkbox" name="checkbox-uecig" id="checkbox-uecig" class="check" />\
 <label for="checkbox-uecig">e-cigarette</label>\
 \
 <input type="checkbox" name="checkbox-uvap" id="checkbox-uvap" class="check" />\
 <label for="checkbox-uvap">Vaporizer</label>\
 \
 <input type="checkbox" name="checkbox-uhookah" id="checkbox-uhookah" class="check" />\
 <label for="checkbox-uhookah">Hookah</label>\
 \
 <input type="checkbox" name="checkbox-uchew" id="checkbox-uchew" class="check" />\
 <label for="checkbox-uchew">Chew</label>\
 \
 <input type="checkbox" name="checkbox-udipsnf" id="checkbox-udipsnf" class="check" />\
 <label for="checkbox-udipsnf">Dip or Snuff</label>\
 \
 <input type="checkbox" name="checkbox-usnus" id="checkbox-usnus" class="check" />\
 <label for="checkbox-usnus">Snus</label>\
 \
 <input type="checkbox" name="checkbox-unourge" id="checkbox-unourge" class="check" />\
 <label for="checkbox-unourge">No urge to use any of these tobacco products</label>\
 </fieldset>\
 </div>';
*/


        var currentActivitySurveyData = {hang:"", tvmus:"", phone:"", texting:"", compint:"", reading:"", schl:"", job:"", eatdrnk:"", alc:"", pot:"", party:"", phys:"", walking:"", club:"", trans:"", noth:"", other:""};
        var currentActivitySurveyTemplate =  '<h3>What are you doing?</h3>\
                                <div id="currentActivitySurveyCheckboxes" data-role="fieldcontain">\
                                   <fieldset class="ui-grid-a">\
                                   \
                                        <div class="ui-block-a">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-hang" id="checkbox-hang" class="check" />\
                                                <label for="checkbox-hang">Hanging out</label>\
                                                \
                                                <input type="checkbox" name="checkbox-tvmus" id="checkbox-tvmus" class="check" />\
                                                <label for="checkbox-tvmus">TV, Music, or Movies</label>\
                                                \
                                                <input type="checkbox" name="checkbox-phone" id="checkbox-phone" class="check" />\
                                                <label for="checkbox-phone">Telephone</label>\
                                                \
                                                <input type="checkbox" name="checkbox-texting" id="checkbox-texting" class="check" />\
                                                <label for="checkbox-texting">Texting</label>\
                                                \
                                                <input type="checkbox" name="checkbox-compint" id="checkbox-compint" class="check" />\
                                                <label for="checkbox-compint">Computer</label>\
                                                \
                                                <input type="checkbox" name="checkbox-reading" id="checkbox-reading" class="check" />\
                                                <label for="checkbox-reading">Reading</label>\
                                                \
                                                <input type="checkbox" name="checkbox-schl" id="checkbox-schl" class="check" />\
                                                <label for="checkbox-schl">Class work</label>\
                                                \
                                                <input type="checkbox" name="checkbox-job" id="checkbox-job" class="check" />\
                                                <label for="checkbox-job">Job</label>\
                                                \
                                                <input type="checkbox" name="checkbox-eatdrnk" id="checkbox-eatdrnk" class="check" />\
                                                <label for="checkbox-eatdrnk">Eating or drinking</label>\
                                            </fieldset>\
                                        </div>\
                                        <div class="ui-block-b">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-alc" id="checkbox-alc" class="check" />\
                                                <label for="checkbox-alc">Drinking alcohol</label>\
                                                \
                                                <input type="checkbox" name="checkbox-pot" id="checkbox-pot" class="check" />\
                                                <label for="checkbox-pot">Marijuana use</label>\
                                                \
                                                <input type="checkbox" name="checkbox-party" id="checkbox-party" class="check" />\
                                                <label for="checkbox-party">Party</label>\
                                                \
                                                <input type="checkbox" name="checkbox-phys" id="checkbox-phys" class="check" />\
                                                <label for="checkbox-phys">Physical activity or Sports</label>\
                                                \
                                                <input type="checkbox" name="checkbox-walking" id="checkbox-walking" class="check" />\
                                                <label for="checkbox-walking">Walking</label>\
                                                \
                                                <input type="checkbox" name="checkbox-club" id="checkbox-club" class="check" />\
                                                <label for="checkbox-club">Organized club</label>\
                                                \
                                                <input type="checkbox" name="checkbox-trans" id="checkbox-trans" class="check" />\
                                                <label for="checkbox-trans">Transit or Driving</label>\
                                                \
                                                <input type="checkbox" name="checkbox-noth" id="checkbox-noth" class="check" />\
                                                <label for="checkbox-noth">Nothing</label>\
                                                \
                                                <input type="checkbox" name="checkbox-other" id="checkbox-other" class="check" />\
                                                <label for="checkbox-other">Other</label>\
                                            </fieldset>\
                                        </div>\
                                    </fieldset>\
                                </div>';

        var wOthersSurveyData = {comp:""};
        var wOthersSurveyTemplate =  '<div id="wOthersSurveyRadios">\
                                          <fieldset data-role="controlgroup">\
                                          <legend>Are you with others?</legend>\
                                              <input type="radio" name="withothers" id="radio-comp1" value="1" class="radio" />\
                                              <label for="radio-comp1">Alone</label>\
                                              \
                                              <input type="radio" name="withothers" id="radio-comp2" value="2" class="radio" />\
                                              <label for="radio-comp2">Alone-others nearby</label>\
                                              \
                                              <input type="radio" name="withothers" id="radio-comp3" value="3" class="radio" />\
                                              <label for="radio-comp3">With other(s)</label>\
                                          </fieldset>\
                                       </div>';


        var whoNearbySurveyData = {alo_wthfam:"", alo_wthpart:"",alo_wthwork:"",alo_wthfr:"",alo_wthoth:""};
        var whoNearbySurveyTemplate = '<h3>Who is nearby?</h3>\
                                <div id="whoNearbySurveyCheckboxes" data-role="fieldcontain">\
                                    <fieldset data-role="controlgroup">\
                                        <input type="checkbox" name="checkbox-alo_wthfam" id="checkbox-alo_wthfam" class="check" />\
                                        <label for="checkbox-alo_wthfam">Family</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthpart" id="checkbox-alo_wthpart" class="check" />\
                                        <label for="checkbox-alo_wthpart">Romantic Partner or Spouse</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthwork" id="checkbox-alo_wthwork" class="check" />\
                                        <label for="checkbox-alo_wthwork">Coworkers</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthfr" id="checkbox-alo_wthfr" class="check" />\
                                        <label for="checkbox-alo_wthfr">Friends or Peers</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthoth" id="checkbox-alo_wthoth" class="check" />\
                                        <label for="checkbox-alo_wthoth">Other</label>\
                                    </fieldset>\
                                </div>';

        var whoFamilySurveyData = {alo_wthmom:"", alo_wthsib:"",alo_wthchild:"",alo_wthdad:"",alo_wthrel:""};
        var whoFamilySurveyTemplate = '<h3>Which family members are nearby (check all that apply)?</h3>\
                                <div id="whoFamilySurveyCheckboxes" data-role="fieldcontain">\
                                    <fieldset data-role="controlgroup">\
                                        <input type="checkbox" name="checkbox-alo_wthmom" id="checkbox-alo_wthmom" class="check" />\
                                        <label for="checkbox-alo_wthmom">Mother</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthsib" id="checkbox-alo_wthsib" class="check" />\
                                        <label for="checkbox-alo_wthsib">Brother(s) or Sister(s)</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthchild" id="checkbox-alo_wthchild" class="check" />\
                                        <label for="checkbox-alo_wthchild">Children</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthdad" id="checkbox-alo_wthdad" class="check" />\
                                        <label for="checkbox-alo_wthdad">Father</label>\
                                        \
                                        <input type="checkbox" name="checkbox-alo_wthrel" id="checkbox-alo_wthrel" class="check" />\
                                        <label for="checkbox-alo_wthrel">Other Relative</label>\
                                    </fieldset>\
                                </div>';

        var nearbyProductUseSurveyData = {ocig:"", olcigar:"", ocigrilo:"", obcigar:"", oecig:"", ovap:"", ohookah:"", ochew:"", odipsnf:"", osnus:"", onone:""};
        var nearbyProductUseSurveyTemplate = '<h3>Are any of these people using any of the following tobacco products (check all that apply)?</h3>\
                                <div id="nearbyProductUseSurveyCheckboxes" data-role="fieldcontain">\
                                   <fieldset class="ui-grid-a">\
                                   \
                                        <div class="ui-block-a">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-ocig" id="checkbox-ocig" class="check" />\
                                                <label for="checkbox-ocig">Cigarette</label>\
                                                \
                                                <input type="checkbox" name="checkbox-olcigar" id="checkbox-olcigar" class="check" />\
                                                <label for="checkbox-olcigar">Little Cigar</label>\
                                                \
                                                <input type="checkbox" name="checkbox-ocigrilo" id="checkbox-ocigrilo" class="check" />\
                                                <label for="checkbox-ocigrilo">Cigarillo</label>\
                                                \
                                                <input type="checkbox" name="checkbox-obcigar" id="checkbox-obcigar" class="check" />\
                                                <label for="checkbox-obcigar">Big Cigar</label>\
                                                \
                                                <input type="checkbox" name="checkbox-oecig" id="checkbox-oecig" class="check" />\
                                                <label for="checkbox-oecig">e-cigarette</label>\
                                                \
                                                <input type="checkbox" name="checkbox-ovap" id="checkbox-ovap" class="check" />\
                                                <label for="checkbox-ovap">Vaporizer</label>\
                                            </fieldset>\
                                        </div>\
                                        \
                                        <div class="ui-block-b">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="checkbox-ohookah" id="checkbox-ohookah" class="check" />\
                                                <label for="checkbox-ohookah">Hookah</label>\
                                                \
                                                <input type="checkbox" name="checkbox-ochew" id="checkbox-ochew" class="check" />\
                                                <label for="checkbox-ochew">Chew</label>\
                                                \
                                                <input type="checkbox" name="checkbox-odipsnf" id="checkbox-odipsnf" class="check" />\
                                                <label for="checkbox-odipsnf">Dip or Snuff</label>\
                                                \
                                                <input type="checkbox" name="checkbox-osnus" id="checkbox-osnus" class="check" />\
                                                <label for="checkbox-osnus">Snus</label>\
                                                \
                                                <input type="checkbox" name="checkbox-onone" id="checkbox-onone" class="check" />\
                                                <label for="checkbox-onone">No one was using a tobacco product</label>\
                                            </fieldset>\
                                        </div>\
                                    </fieldset>\
                                </div>';

        var locationSurveyData= {locat3:""};
        var locationSurveyTemplate= '<h3>Right now, where are you?</h3>\
                                      <div id="locationSurveyRadios" data-role="fieldcontain">\
                                           <fieldset class="ui-grid-a">\
                                           \
                                                <div class="ui-block-a">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="whereareyou" id="radio-locat31" value="1" class="radio"/>\
                                                        <label for="radio-locat31">Your home</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat32" value="2" class="radio"/>\
                                                        <label for="radio-locat32">Parent\'s home</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat33" value="3" class="radio"/>\
                                                        <label for="radio-locat33">Friend\'s home</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat34" value="4" class="radio"/>\
                                                        <label for="radio-locat34">School</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat35" value="5" class="radio"/>\
                                                        <label for="radio-locat35">Work</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat36" value="6" class="radio"/>\
                                                        <label for="radio-locat36">In car</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat37" value="7" class="radio"/>\
                                                        <label for="radio-locat37">Other transit</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat38" value="8" class="radio"/>\
                                                        <label for="radio-locat38">Bar or club</label>\
                                                    </fieldset>\
                                                </div>\
                                                <div class="ui-block-b">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="whereareyou" id="radio-locat39" value="9" class="radio"/>\
                                                        <label for="radio-locat39">Coffee shop</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat310" value="10" class="radio"/>\
                                                        <label for="radio-locat310">Restaurant</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat311" value="11" class="radio"/>\
                                                        <label for="radio-locat311">Hookah lounge</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat312" value="12" class="radio"/>\
                                                        <label for="radio-locat312">Sport venue</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat313" value="13" class="radio"/>\
                                                        <label for="radio-locat313">Entertainment venue</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat314" value="14" class="radio"/>\
                                                        <label for="radio-locat314">Outside-public property</label>\
                                                        \
                                                        <input type="radio" name="whereareyou" id="radio-locat315" value="15" class="radio" />\
                                                        <label for="radio-locat315">Other</label>\
                                                    </fieldset>\
                                                </div>\
                                           </fieldset>\
                                      </div>';

        var firstRadioSetSurveyData={smklocat:"", antimsg:"", promsg: ""};
        var firstRadioSetSurveyTemplate= '<div id="firstRadioSetSurveyRadios">\
                                                <fieldset data-role="controlgroup">\
                                                    <legend>Is smoking cigarettes allowed in this location?</legend>\
                                                        <input type="radio" name="smokinglocation" id="radio-smklocat2" value="2" class="radio"/>\
                                                        <label for="radio-smklocat2">Yes</label>\
                                                        \
                                                        <input type="radio" name="smokinglocation" id="radio-smklocat1" value="1" class="radio"/>\
                                                        <label for="radio-smklocat1">No</label>\
                                                </fieldset>\
                                                \
                                                <fieldset data-role="controlgroup">\
                                                    <legend>In the last hour, have you seen or heard any anti-smoking or stop-smoking messages?</legend>\
                                                        <input type="radio" name="antimessage" id="radio-antimsg2" value="2" class="radio"/>\
                                                        <label for="radio-antimsg2">Yes</label>\
                                                        \
                                                        <input type="radio" name="antimessage" id="radio-antimsg1" value="1" class="radio"/>\
                                                        <label for="radio-antimsg1">No</label>\
                                                </fieldset>\
                                                \
                                                <fieldset data-role="controlgroup">\
                                                    <legend>In the last hour, have you seen or heard any cigarette or tobacco promotions or advertising?</legend>\
                                                        <input type="radio" name="promessage" id="radio-promsg2" value="2" class="radio"/>\
                                                        <label for="radio-promsg2">Yes</label>\
                                                        \
                                                        <input type="radio" name="promessage" id="radio-promsg1" value="1" class="radio"/>\
                                                        <label for="radio-promsg1">No</label>\
                                                </fieldset>\
                                           </div>';


        var secondRadioSetSurveyData={alchour:"", pothour:""};
        var secondRadioSetSurveyTemplate= '<div id="secondRadioSetSurveyRadios">\
                                                <fieldset data-role="controlgroup">\
                                                    <legend>Did you drink alcohol in the last hour?</legend>\
                                                        <input type="radio" name="alcoholhour" id="radio-alchour2" value="2" class="radio"/>\
                                                        <label for="radio-alchour2">Yes</label>\
                                                        \
                                                        <input type="radio" name="alcoholhour" id="radio-alchour1" value="1" class="radio"/>\
                                                        <label for="radio-alchour1">No</label>\
                                                </fieldset>\
                                                \
                                                <fieldset data-role="controlgroup">\
                                                    <legend>Have you used marijuana in the last hour?</legend>\
                                                        <input type="radio" name="pothour" id="radio-pothour2" value="2" class="radio"/>\
                                                        <label for="radio-pothour2">Yes</label>\
                                                        \
                                                        <input type="radio" name="pothour" id="radio-pothour1" value="1" class="radio"/>\
                                                        <label for="radio-pothour1">No</label>\
                                                </fieldset>\
                                            </div>';


        var tobProductSurveyData={TUProduct:""};
        var tobProductSurveyTemplate='<h3>What type of tobacco product did you use?</h3>\
                                      <div id="tobProductSurveyRadios" data-role="fieldcontain">\
                                           <fieldset class="ui-grid-a">\
                                                <div class="ui-block-a">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="productused" id="radio-tuproduct1" value="1" class="radio"/>\
                                                        <label for="radio-tuproduct1">Cigarette</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct2" value="2" class="radio"/>\
                                                        <label for="radio-tuproduct2">Little Cigar</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct3" value="3" class="radio"/>\
                                                        <label for="radio-tuproduct3">Cigarillo</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct4" value="4" class="radio"/>\
                                                        <label for="radio-tuproduct4">Big Cigar</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct5" value="5" class="radio"/>\
                                                        <label for="radio-tuproduct5">e-cigarette</label>\
                                                        \
                                                    </fieldset>\
                                                </div>\
                                                <div class="ui-block-b">\
                                                    <fieldset data-role="controlgroup">\
                                                        <input type="radio" name="productused" id="radio-tuproduct6" value="6" class="radio"/>\
                                                        <label for="radio-tuproduct6">Vaporizer</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct7" value="7" class="radio"/>\
                                                        <label for="radio-tuproduct7">Hookah</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct8" value="8" class="radio"/>\
                                                        <label for="radio-tuproduct8">Chew</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct9" value="9" class="radio"/>\
                                                        <label for="radio-tuproduct9">Dip/Snuff</label>\
                                                        \
                                                        <input type="radio" name="productused" id="radio-tuproduct10" value="10" class="radio"/>\
                                                        <label for="radio-tuproduct10">Snus</label>\
                                                    </fieldset>\
                                                </div>\
                                           </fieldset>\
                                      </div>';


        var cigMentholSurveyData = {cigment:""};
        var cigMentholSurveyTemplate = '<h3>For <span style=”text-decoration:underline;”>cigarette</span>, was the cigarette menthol?</h3>\
                                            <div id="cigMentholSurveyRadios" align="center">\
                                                <fieldset data-role="controlgroup">\
                                                    <input type="radio" name="cigmenthol" id="radio-menthol2" value="2" class="radio"/>\
                                                    <label for="radio-menthol2">Yes</label>\
                                                    \
                                                    <input type="radio" name="cigmenthol" id="radio-menthol1" value="1" class="radio"/>\
                                                    <label for="radio-menthol1">No</label>\
                                                </fieldset>\
                                             </div>';

        var suspenddata = {suspendval:""};
        var suspendTemplate = '<h3>Select a period and a reason for suspending the application:</h3>\
                                <form id="suspend-form">\
                                    <fieldset data-role="fieldcontain">\
                                        <label for="suspend-select1">Select suspend amount</label>\
                                        <select name="suspend-select1" id="suspend-select1" data-native-menu="false">\
                                            <option value="30">30 mins</option>\
                                            <option value="60">60 mins</option>\
                                            <option value="90">1.5 hrs</option>\
                                            <option value="120">2 hrs</option>\
                                            <option value="150">2.5 hrs</option>\
                                            <option value="180">3 hrs</option>\
                                            <option value="210">3.5 hrs</option>\
                                            <option value="240">4 hrs</option>\
                                        </select>\
                                    \
                                        <label for="suspend-select2">Select the reason for suspension</label>\
                                        <select name="suspend-select2" id="suspend-select2" data-native-menu="false">\
                                            <option value="1">Transit</option>\
                                            <option value="2">Class</option>\
                                            <option value="3">Org. Activity</option>\
                                            <option value="4">Quiet Place</option>\
                                            <option value="5">Nap</option>\
                                            <option value="6">Job</option>\
                                            <option value="7">Other</option>\
                                        </select>\
                                    </fieldset>\
                                 </form>';

        var wakeTimedata = {wakeTimedata:""};
        var wakeTimeTemplate = '<div data-role="fieldcontain">\
                                    <label for="wscroller">Wake Time:</label>\
                                    <input id="wscroller" name="wscroller" placeholder="tap to enter your wake time..."/>\
                                </div>';


        var problemreportdata = {problemreporttitle:"", problemreportdetail:""};
        var problemreportTemplate = '<label for="problemdetail">Enter the problem below, and hit \'submit report\'</label>\
                <textarea id="problemdetail" name="notestextarea" form="notes" placeholder="Tap to enter the problem"></textarea>';

        var referencedata = {referencedata:""};
        var referenceTemplate = '<div data-role="collapsible-set">\
                                <div data-role="collapsible">\
                                    <h3>Tobacco Survey</h3>\
                                    <p>Reference for different aspects of the tobacco survey</p>\
                                    <div data-role="collapsible" id="reference-surveym">\
                                        <h3>Tobacco Use Interview</h3>\
                                        <p>This survey is to be completed by the user whenever they finish a tobacco product. \
                                        \n\nSimply open up the application, tap "Tobacco use survey",\
                                         and complete the questionnaire until you are taken to the main menu.</p>\
                                    </div>\
                                    <div data-role="collapsible" id="reference-surveyA">\
                                        <h3>Random Prompt Notifications</h3>\
                                        <p>There will be around seven randomized notifications a day, please complete all surveys when notified, if possible.\
                                        \n\nSimply tap on the notification once it pops up in your Android phone\'s status bar. This will take you to the main\
                                         menu of the application where you will click on "Tobacco use survey" to take the survey.\
                                         Once the survey is complete, you will be taken back to the main menu.</p>\
                                    </div>\
                                    <div data-role="collapsible" id="reference-surveywidgets">\
                                        <h3>Survey Questions</h3>\
                                        <p>Slider questions- Simply tap and hold the slider knob of the slider and drag it left or right. \
                                        The blue graphic that follows the sliding knob indicates the level of intensity for that related slider.</p>\
                                        <p>Example:</p>\
                                        <div data-role="fieldcontain">\
                                            <label for="reference-slider">Happy: </label>\
                                            <input type="range" name="reference-slider" id="reference-slider" value="5" min="1" max="10" data-highlight="true" />\
                                        </div>\
                                        <p>Checkbox questions- Check all choices that match the questionnaire at the top of the survey page.</p>\
                                        <p>Example:</p>\
                                        <div data-role="fieldcontain">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="checkbox" name="reference-check1" id="reference-check1" class="check" />\
                                                <label for="reference-check1">Checkbox 1</label>\
                                                <input type="checkbox" name="reference-check2" id="reference-check2" class="check" />\
                                                <label for="reference-check2">Checkbox 2</label>\
                                                <input type="checkbox" name="reference-check3" id="reference-check3" class="check" />\
                                                <label for="reference-check3">Checkbox 3</label>\
                                                <input type="checkbox" name="reference-check4" id="reference-check4" class="check" />\
                                                <label for="reference-check4">Checkbox 4</label>\
                                                <input type="checkbox" name="reference-check5" id="reference-check5" class="check" />\
                                                <label for="reference-check5">Checkbox 5</label>\
                                            </fieldset>\
                                        </div>\
                                        <p>Radiobox questions- Check only one response that matches the questionnaire at the top of the suvey page. \
                                        These questions function the same as checkbox questions, but will only accept one answer instead of multiple answers.</p>\
                                        <p>Example: </p>\
                                        <div data-role="fieldcontain">\
                                            <fieldset data-role="controlgroup">\
                                                <input type="radio" name="reference-radio" id="reference-radio1" class="radio" />\
                                                <label for="reference-radio1">Radiobox 1</label>\
                                                <input type="radio" name="reference-radio" id="reference-radio2" class="radio" />\
                                                <label for="reference-radio2">Radiobox 2</label>\
                                                <input type="radio" name="reference-radio" id="reference-radio3" class="radio" />\
                                                <label for="reference-radio3">Radiobox 3</label>\
                                            </fieldset>\
                                        </div>\
                                    </div>\
                                </div>\
                                \
                                <div data-role="collapsible">\
                                    <h3>Notifications</h3>\
                                    <p>Click the button below to see an example of the notification that will be sent to your device throughout the day.</p>\
                                    <a href="#" data-role="button" onclick="fireExampleNotification()">Click here for a notification</a>\
                                </div>\
                                \
                                <div data-role="collapsible">\
                                    <h3>Bedtime</h3>\
                                    <p>Use the time scroll wheel to select a time of the day that you do not want to receive notifications. This period will last 10 hours.\n\n\
                                    You will receive seven randomized notifications throughout the day, save for this 10 hour period.</p>\
                                </div>\
                                \
                                <div data-role="collapsible">\
                                    <h3>Suspend</h3>\
                                    <p>Select a period of time from the drop-down menu on the left for which you do not want to receive notifications. This will push all future notifications\
                                    back by that amount.\n\n\
                                    Be aware that you are supposed to complete around seven notifications a day.\n\n\
                                    Select the reason for suspending notification on the right drop-down menu.</p>\
                                </div>\
                            </div>';



		$(document).on("pageinit",function(){

            $(".jquerymobileslider").on("change", function () {
                $(this).closest(".ui-slider").find("a .ui-btn-text").html($(this).val());
             }).on("keyup", function () {
                            $(this).closest(".ui-slider").find("a .ui-btn-text").html($(this).val());
                });

            $(".ui-slider-input").prop("readonly", true);

            /*
            console.log('visitedEmoSurveyA: ' + visitedEmoSurveyA);
            console.log('visitedEmoSurveyB: ' + visitedEmoSurveyB);
            console.log('visitedEmoSurveyC: ' + visitedEmoSurveyC);
            */

            if(!visitedEmoSurveyA){
                $("#emoSurveyA .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedEmoSurveyB){
                $("#emoSurveyB .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedEmoSurveyC){
                $("#emoSurveyC .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedBeforeTobEmoSurveyA){
                $("#beforeTobEmoSurveyA .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedBeforeTobEmoSurveyB){
                $("#beforeTobEmoSurveyB .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedBeforeTobEmoSurveyC){
                $("#beforeTobEmoSurveyC .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            if(!visitedWhenUsingTobSurvey){
                $("#whenUsingTobSurvey .jquerymobileslidercont .ui-slider-handle").css("left", "50%");
            }

            $('#wscroller').mobiscroll().time({
                theme: 'default',
                display: 'modal',
                mode: 'scroller',
                setText: 'Ok',
                cancelText: 'Cancel',
                headerText: 'Set your wake time'
            });


            $('#wscroller').mobiscroll({preset: 'time', onSelect: function(valueText, inst){
                console.log(valueText);



            }});
            $('#wscroller').mobiscroll('option', { stepMinute: 5 });




            $("#delay").on("pagecreate", function(){
                var html = Mustache.to_html(delayTemplate, delayData);
                $("#delaycontent").html(html);
                //$("#ajaxSpinner").hide("fast");
            });


            $("#main").on("pagecreate", function(){
                //Change size of survey button and it's font size
                $("#button-mainsurvey").css('height','50px');
                $("#button-mainsurvey").children().children().css('font-size','28px');

            });

            $("#emoSurveyA").on("pagecreate", function(){
				var html = Mustache.to_html(emoSurveyATemplate, emoSurveyAData);
				$("#emoSurveyAcontent").html(html);

			});


            $("#emoSurveyB").on("pagecreate", function(){
                var html = Mustache.to_html(emoSurveyBTemplate, emoSurveyBData);
                $("#emoSurveyBcontent").html(html);
            });


            $("#emoSurveyC").on("pagecreate", function(){
                var html = Mustache.to_html(emoSurveyCTemplate, emoSurveyCData);
                $("#emoSurveyCcontent").html(html);
            });



            $("#beforeTobEmoSurveyA").on("pagecreate", function(){
                var html = Mustache.to_html(beforeTobEmoSurveyATemplate, beforeTobEmoSurveyAData);
                $("#beforeTobEmoSurveyAcontent").html(html);

            });


            $("#beforeTobEmoSurveyB").on("pagecreate", function(){
                var html = Mustache.to_html(beforeTobEmoSurveyBTemplate, beforeTobEmoSurveyBData);
                $("#beforeTobEmoSurveyBcontent").html(html);
            });


            $("#beforeTobEmoSurveyC").on("pagecreate", function(){
                var html = Mustache.to_html(beforeTobEmoSurveyCTemplate, beforeTobEmoSurveyCData);
                $("#beforeTobEmoSurveyCcontent").html(html);
            });

            $("#whenUsingTobSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(whenUsingTobSurveyTemplate, whenUsingTobSurveyData);
                $("#whenUsingTobSurveycontent").html(html);
            });


            $("#productUrgeSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(productUrgeSurveyTemplate, productUrgeSurveyData);
                $("#productUrgeSurveyContent").html(html);
            });

            $("#currentActivitySurvey").on("pagecreate", function(){
                var html = Mustache.to_html(currentActivitySurveyTemplate, currentActivitySurveyData);
                $("#currentActivitySurveyContent").html(html);
            });

            $("#wOthersSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(wOthersSurveyTemplate, wOthersSurveyData);
                $("#wOthersSurveyContent").html(html);
            });

            $("#whoNearbySurvey").on("pagecreate", function(){
                var html = Mustache.to_html(whoNearbySurveyTemplate, whoNearbySurveyData);
                $("#whoNearbySurveyContent").html(html);

                //console.log("within whoNearbySurvey.on(\"pagecreate\")");
            });

            $("#whoFamilySurvey").on("pagecreate", function(){
                var html = Mustache.to_html(whoFamilySurveyTemplate, whoFamilySurveyData);
                $("#whoFamilySurveyContent").html(html);
                //console.log("within whoFamilySurvey.on(\"pagecreate\")");
            });

            $("#nearbyProductUseSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(nearbyProductUseSurveyTemplate, nearbyProductUseSurveyData);
                $("#nearbyProductUseSurveyContent").html(html);
                //console.log("within nearbyProductUseSurvey.on(\"pagecreate\")");
            });

            $("#locationSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(locationSurveyTemplate, locationSurveyData);
                $("#locationSurveyContent").html(html);
                //console.log("within locationSurvey.on(\"pagecreate\")");
            });

            $("#firstRadioSetSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(firstRadioSetSurveyTemplate, firstRadioSetSurveyData);
                $("#firstRadioSetSurveyContent").html(html);
                //console.log("within firstRadioSetSurvey.on(\"pagecreate\")");
            });

            $("#secondRadioSetSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(secondRadioSetSurveyTemplate, secondRadioSetSurveyData);
                $("#secondRadioSetSurveyContent").html(html);
                //console.log("within secondRadioSetSurvey.on(\"pagecreate\")");
            });

            $("#tobProductSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(tobProductSurveyTemplate, tobProductSurveyData);
                $("#tobProductSurveyContent").html(html);
            });

            $("#cigMentholSurvey").on("pagecreate", function(){
                var html = Mustache.to_html(cigMentholSurveyTemplate, cigMentholSurveyData);
                $("#cigMentholSurveyContent").html(html);

            });

			$("#suspend").on("pagecreate", function(){
				var html = Mustache.to_html(suspendTemplate, suspenddata);
				$("#suspendcontent").html(html);
			});


			$("#wakeTime").on("pagecreate",function(){
				var html3 = Mustache.to_html(wakeTimeTemplate, wakeTimedata);
                $("#wakeTimecontent").html(html3);

                $('#wscroller').mobiscroll({onSelect: function(valueText, inst){
                    console.log(valueText);
                }});
			});

			$("#problemreport").on("pagecreate",function(){
				var html4 = Mustache.to_html(problemreportTemplate, problemreportdata);
				$("#problemreportcontent").html(html4);

                $("#problemdetail").height(100);
			});

			$("#reference").on("pagecreate",function(){
				var html5 = Mustache.to_html(referenceTemplate, referencedata);
				$("#referencecontent").html(html5);
			});

            $("#wakeup").on("pagecreate",function(){
                $("#button-wakeup").css('height','100px');
                $("#button-wakeup").children().children().css('font-size','40px');
                $("#button-snooze").css('height','100px');
                $("#button-snooze").children().children().css('font-size','40px');
            });

		});

        $(document).on('pagebeforecreate', '[data-role="page"]', function(){
            setTimeout(function(){
                $.mobile.loading('show');
            },1);
        });

        $(document).on('pageshow', '[data-role="page"]', function(){
            setTimeout(function(){
                $.mobile.loading('hide');
            },300);
        });



        function loadingDelay(){
            $.mobile.loading('show', {
                text: "loading",
                textVisible: true
            });

            console.log("\nloadingDelay");
        }


        function loadingDelayIsDone(){
            $.mobile.loading("hide");
            console.log("\nloadingDelayIsDone");
        }


        function userHasGoneIdle(){

            window.plugin.backgroundMode.enable();

            //If user goes idle and has started a random prompt survey but has not finished it before going idle,
            //Need to record a survey as being abandoned
            if(startedRandomPromptSurvey && !finishedRandomPromptSurvey){

                //If a user delays a notification, don't want to add to missing notifications file yet.
                if(currentState != states.DELAYED){
                    hasMissedNotification = true;
                    addToMissedNotifications(1, moment().toDate().toString());
                    startedRandomPromptSurvey = false;
                    finishedRandomPromptSurvey = false;
                }
                //If a user clicks a notification (indicates that they have started a random prompt interview), delays notification,
                //then misses the delayed notificaiton, it will register both an abandoned as well as a missed, when really they have only missed
                //the last delayed notification
            }

            writingToRandomPromptInt = false;
            $("#login-password").val('');

            if(!wakeUpFiring)
                $.mobile.navigate('#login');
            else
                $.mobile.navigate('#wakeup');
            resetSurveyWidgets();

            console.log('userHasGoneIdle');
        }

        function onBackKeyDown(e) {
            e.preventDefault();
        }

        //Cleans up notifications that have fired longer than three minutes ago, to be called upon resume
        function cancelPassedNotifications(){

            var now = moment();

            for(var i= 0; i < notificationTimes.length; i++){
                if(now.isAfter(moment(notificationTimes[i]).add('minutes', 3))){
                    if(didMissNotificationArr[i]){

                        window.plugin.notification.local.cancel(i);
                    }
                }
                else if(notificationTimes[i].isAfter(now)){
                    break;
                }
            }

            if(my_media){
                my_media.stop();
                //my_media.reset();
                my_media.release();
            }

        }

        function onResumeApp(){
            console.log('\nonResumeApp()');

            console.log("timeAsleep: " + timeAsleep);

            console.log("timeAwake: " + timeAwake);



            /*
            window.plugin.notification.local.getScheduledIds( function (scheduledIds) {
                 console.log('Scheduled IDs: ' + scheduledIds.join(' ,'));
            });
            */

            //Check to see if there is a suspension time set, if so, check to see if that time has passed, if so, resume normal app behavior
            if(resumeTime != null){

                //in the case of delaying a notification, need to change currentState to active through a timeout function...
                // otherwise causes error in how missing a delayed a notification counts more than once
                if(moment().isAfter(resumeTime)){
                    currentState = states.ACTIVE;
                    displayAppStatus(states.ACTIVE);
                    resumeTime = null;
                }
            }

            if (hasMissedNotification){
                alert("You have missed " + missedNotifications + " random prompt survey(s). Please remember to take as many surveys as possible.");
                hasMissedNotification = false;
                missedNotifications = 0;
            }

            //Need to check size of scheduledIds, if it is zero, then that means the the user has cleared notifications
            //from the Android clear device button... need to repopulate all new notifications



            window.plugin.notification.local.getScheduledIds( function (scheduledIds){
                //if no, or only one notification to be scheduled, repopulate

                console.log("LENGTH OF scheduledIds: " + scheduledIds.length);
                console.log("@ onResume notificationCount: " + notificationCount);


                //IN CASE OF # of NOTIFICATIONS REACHING 0, REPOPULATE
                // Also,
                //ODD BUG WHERE NOTIFICATIONS WILL NOT BE CLEARED PRIOR TO BEING ADDED... GENERALLY MORE THAN 2x SURVEYSINADAY will be added with duplicate notifications in a day
                //2.5 because num would be greater than 2x surveysaday, but delaying a notification will also increase length, so there could legitimately be more than 2x surveys a day
                if(scheduledIds.length <= 1 || scheduledIds.length > parseInt(2.5 * surveysInADay)){
                  //while(scheduledIds.length == 0){

                    if(currentState == states.DELAYED){

                        //With no notifications now, addNewNotifications and remove the one that might be before the resumeTime, but after now
                        //Then add a notification at resume time
                        clearPriorNotifications(function(){
                            addNewNotifications(function(){
                                //difference between number of notifications actually added and number of notification times partitioned:
                                var diff = Math.abs(notificationCount - partitionTimes.length);
                                var translatedIndex;

                                console.log('\nnotificationCount: ' + notificationCount);
                                console.log('\nnotificationsLen:  ' + partitionTimes.length);

                                console.log('\ndiff: ' + diff);

                                for(var i = 0; i < partitionTimes.length; i++){

                                    //notification IDs are stored by the actual count of the notification, not from the notification index of their related time
                                    if (partitionTimes[i].isAfter(now) && partitionTimes[i].isBefore(resumeTime)){
                                        //translatedIndex is also the id of notification to cancel
                                        console.log('\ni:    ' + i);
                                        console.log('\ndiff: ' + diff);
                                        translatedIndex = (i - diff) + 1;
                                        console.log('\ntranslatedIndex: ' + translatedIndex);

                                        window.plugin.notification.local.cancel(translatedIndex);

                                        delayNotification(true);

                                        break;
                                    }
                                }

                                formNotificationString(writeToNotificationFile);
                            });
                        })
                    }

                    else if(currentState == states.SUSPENDED){
                        clearPriorNotifications(function(){
                            addNewNotifications(function(){
                                formNotificationString(writeToNotificationFile);
                                suspendNotifications(true);
                            })
                        });
                    }


                    else if(currentState == states.ASLEEP){
                        clearPriorNotifications(function(){
                            addNewNotifications(function(){
                                formNotificationString(writeToNotificationFile);
                            });
                        });
                    }

                    else if(currentState == states.ACTIVE){
                        clearPriorNotifications(function(){
                            addNewNotifications(function(){
                                formNotificationString(writeToNotificationFile);
                            });
                        });
                    }




                }


            });

        }

		function onLoad() {
			document.addEventListener("deviceready", onDeviceReady, false);
		}




//***************onDeviceReady()
		function onDeviceReady() {
            console.log("WITHIN onDeviceReady()");
            //determineWakeTimeBedTime();

            //For the BGS Plugin:
            var serviceName = 'com.red_folder.phonegap.plugin.backgroundservice.EcigService';
            var factory = cordova.require('com.red_folder.phonegap.plugin.backgroundservice.EcigService');

            eCigService = factory.create(serviceName);
            go();

            window.plugin.notification.local.onadd = function(id, state, json){
                //console.log('\nonadd() adding #: ' + id.toString());
                //console.log('\nJSON date: ' + JSON.parse(json).date);
                //console.log('\nonadd() adding #' + id + ' fires @ ' + JSON.parse(json).date);

            };

            window.plugin.notification.local.ontrigger = function (id, state, json) {
                console.log('\nontrigger() #' + id + " State: " + state + " @" + moment().toString());// + ' @' + JSON.parse(json).date);

                if(Math.abs(id >= notificationCount - 1 || notificationCount == 0)){
                    console.log('id - notificationCount == 0:' + id + ' - ' + notificationCount + ' = ' + (id - notificationCount));

                    clearPriorNotifications(function(){
                        addNewNotifications(function(){
                            formNotificationString(writeToNotificationFile);
                        });
                    });
                }

                triggerTime = moment().toDate().toString();

                if(id == 0)
                    didMissDelayedNotification = true;

                if(id != -99){
                    playNotificationAudio();
                }
                //In the case that the user does not access app when an alarm goes off by clicking notification,
                //Have app navigate to wakeup screen
                else{
                    playAlarmAudio();
                    didMissWakeUp = true;
                    wakeUpFiring = true;
                    $.mobile.navigate("#wakeup");
                }

                setTimeout(function(){
                    if(id != -1 && id != -99){
                            //if Havent clicked on a notificaiton, and the notificaiton snt a delayed notificaiton,
                            if(id != 0 && didMissNotificationArr[parseInt(id)]){
                                console.log("@onTrigger: didMissNotificationArr[" + id + "] = " + didMissNotificationArr[id]);
                                hasMissedNotification = true;
                                addToMissedNotifications(2, triggerTime);
                                window.plugin.notification.local.cancel(id);
                            }

                            //for missed delayed notifications, only log missed if not clicked and only cancel if not clicked (and therefore cnaceled)
                            else if(id == 0 && didMissDelayedNotification){
                                console.log("@onTrigger: didMissDelayedNotification = " + didMissDelayedNotification);
                                hasMissedNotification = true;
                                addToMissedNotifications(2, triggerTime);
                                window.plugin.notification.local.cancel(id);
                            }

                    }
                    //Need to set boolean to remain at #wakeup, regardless of whether or not the user leaves the app during
                    //wakeup alarm
                    else if(id == -99 && didMissWakeUp){
                        wakeUpFiring = false;
                        window.plugin.notification.local.cancel(id);
                    }
                    else if(id == -1)
                        window.plugin.notification.local.cancel(id);

                }, (180 * 1000));
                //}, (60 * 1000));
            };

            window.plugin.notification.local.onclick = function(id, state, json){

                console.log('\n clicking notification #' + id);
                //notificationTime = JSON.parse(json).date;

                //When clicking on a delayed notification
                if(id == 0){
                    $.mobile.navigate('#delay');
                    didMissDelayedNotification = false;
                    startedRandomPromptSurvey = true;
                    finishedRandomPromptSurvey = false;
                }

                //When clicking on a test notification
                else if(id == -1){
                    $.mobile.navigate("#login");
                    takingTestSurvey = true;
                    startedRandomPromptSurvey = false;
                    finishedRandomPromptSurvey = false;
                }

                //When clicking on a wakeup notification
                else if(id == -99){
                    $.mobile.navigate("#wakeup");
                    startedRandomPromptSurvey = false;
                    finishedRandomPromptSurvey = false;
                }

                //When clicking on a standard, untouched notification
                else{
                    $.mobile.navigate('#delay');
                    startedRandomPromptSurvey = true;
                    finishedRandomPromptSurvey = false;
                    didMissNotificationArr[parseInt(id)] = false;
                }

                //test if the clicked notification is from the reference page... in which case no need to enable auto survey

            };

            window.plugin.notification.local.oncancel = function (id, state, json) {
                console.log('\n CANCELLING notification #' + id + " State: " + state);
                //console.log("caller is " + arguments.callee.caller.toString());

                if(id != -99){
                    if(my_media){
                        my_media.stop();
                        //my_media.reset();
                        my_media.release();
                    }
                }

                //If wake up alarm notificaiton:
                else{
                    wakeUpFiring = false;
                    //$.mobile.navigate("#login");
                    if(my_alarm_media){
                        my_alarm_media.stop();
                        //my_media.reset();
                        my_alarm_media.release();
                    }
                }
            };

            /*
            window.plugin.notification.local.oncancel = function (id, state, json) {
                console.log('\n CANCELLING notification #' + id + " State: " + state);
                //console.log("caller is " + arguments.callee.caller.toString());

                if(id != -99){
                    if(my_media){
                        my_media.stop();
                        //my_media.reset();
                        my_media.release();
                    }
                }

                //If wake up alarm notificaiton:
                else{
                    wakeUpFiring = false;
                    //$.mobile.navigate("#login");
                    if(my_alarm_media){
                        my_alarm_media.stop();
                        //my_media.reset();
                        my_alarm_media.release();
                    }
                }
            };
            */



            document.addEventListener("pause", userHasGoneIdle , false);
            document.addEventListener("backbutton", onBackKeyDown, false);
            document.addEventListener("resume", onResumeApp, false);

            determineWhichLogin();

            //setTimeout because I am apparently using callback functions incorrectly...

            clearPriorNotifications(function(){
                addNewNotifications(function(){
                    formNotificationString(writeToNotificationFile);
                });
            });

        }

        /**
         * SERVICE CODE:
        */
        function getStatus() {
           eCigService.getStatus(function(r){displayResult(r)}, function(e){displayError(e)});
        }

        function displayResult(data) {
            alert("Is service running: " + data.ServiceRunning);
        }

        function displayError(data) {
            alert("We have an error" + data.ErrorMessage + JSON.stringify(data));
        }

        function handleSuccess(data) {
            alert("@handleSuccess");
        }

        function handleError(data) {
            alert("Error: " + data.ErrorMessage);
            alert(JSON.stringify(data));
            //updateView(data);
        }

        //Writes to label at login
        function updateHandler(data) {
            if (data.LatestResult != null) {
                try {
                    var resultMessage = document.getElementById("resultMessage");
                    resultMessage.innerHTML = data.LatestResult.Message;
                } catch (err) {
                }
            }
        }

        function go() {
            eCigService.getStatus(function(r){startService(r)}, function(e){displayError(e)});
        };

        function startService(data) {
            if (data.ServiceRunning) {
                enableTimer(data);
            } else {
                eCigService.startService(function(r){enableTimer(r)}, function(e){displayError(e)});
            }
        }

        function enableTimer(data) {
            if (data.TimerEnabled) {
                registerForUpdates(data);
            } else {
                eCigService.enableTimer(60000, function(r){registerForUpdates(r)}, function(e){displayError(e)});
            }
        }

        function registerForUpdates(data) {
            if (!data.RegisteredForUpdates) {
                eCigService.registerForUpdates(function(r){updateHandler(r)}, function(e){displayError(e)});
            }
        }

        /*
        *
        * End of Service code
        * */


        function clearPriorNotifications(callback){
            console.log("\nclearPriorNotifications()");
            //console.log("caller is " + arguments.callee.caller.toString());

            notificationCount = 0;
            partitionTimes = [];
            notificationTimes = [];
            didMissNotificationArr = [];
            window.plugin.notification.local.cancelAll();

            if (typeof callback === "function"){

                setTimeout(function(){
                callback();

                }, 3 * 1000);
                /*
                setTimeout(function(){

                    window.plugin.notification.local.getScheduledIds(function(schedIDS){
                        console.log("Length of ScheduleIds after callback");
                    })

                }, 10 * 1000);


                window.plugin.notification.local.getScheduledIds(function(schedIDS){
                    console.log("Length of ScheduleIds after callback: " + schedIDS.length);
                })
                 */
            }

            /*
            setTimeout(function(){

                window.plugin.notification.local.getScheduledIds(function(schedIDS){
                    console.log("Length of ScheduleIds before callback");
                })

            }, 7 * 1000);


            window.plugin.notification.local.getScheduledIds(function(schedIDS){
                console.log("Length of ScheduleIds before callback: " + schedIDS.length);
            })
             */
        }

        function vibrate(amt) {
            navigator.notification.vibrate(amt * 1000);
        }
        function playBeep(amt) {
            navigator.notification.beep(amt);
        }

        function exitFromApp(){
            navigator.app.exitApp();
        }

        //if Bed exists, grab those two variables from the strings within the file and set as bedTimeDate and wakeTimeDate
        //if the file does not exist, set wake and bed time to defaults
        function determineWakeTimeBedTime(callback){
            //console.log('\ndetermineWakeTimeBedTime()');

            exists('Bed.bed', function(value){
                if(value){

                    console.log("Bed found");

                    window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                        var entry = fs.root;
                        entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                            directory.getFile('Bed.bed', null, function(fe){
                                //console.log('\nwithin readFromFile wakeTimeBedTime getFile()');
                                fe.file(function(file){
                                    //console.log('\nwithin readFromFile wakeTimeBedTime file()');

                                    var tempReader = new FileReader();
                                    var content;
                                    var lines = [];

                                    tempReader.onloadend = function(evt){
                                        //console.log("\nRead as text, wakeTimeBedTime");
                                        content = evt.target.result;
                                        lines = content.split(/\r\n|\r|\n/g);

                                        wakeTimeDate = moment(lines[0]);
                                        bedTimeDate = moment(lines[1]);

                                        //When holding waketime bedtime dates from long ago, need to update times to current date in order to add notifications
                                        //compare days:
                                        //for the case the waketime = day 6 and bedtime = day 7, need to update date to correctly restore notifications times
                                        if(wakeTimeDate.date() != bedTimeDate.date()){
                                            var todaysDay = moment().date();
                                            var yesterdaysDay = moment().subtract('days', 1).date();

                                            wakeTimeDate.date(yesterdaysDay);
                                            bedTimeDate.date(todaysDay);
                                        }
                                        //for the case that waketime = day 7 and bedtime = day 7...need to update date to correctly restore notificaiton times
                                        else{
                                            var todaysDay = moment().date();

                                            wakeTimeDate.date(todaysDay);
                                            bedTimeDate.date(todaysDay)
                                        }

                                        timeAsleep = Math.abs(moment(bedTimeDate).diff(moment(wakeTimeDate), 'minutes'));
                                        timeAsleep = Math.abs(timeAsleep - (24 * 60));

                                        //if turning on phone during 'bedtime', update login screens appearance to reflect that and set resumetime
                                        if(moment().isAfter(bedTimeDate)){
                                            displayAppStatus(states.ASLEEP);
                                            resumeTime = moment(bedTimeDate).add('minutes', timeAsleep);//set time at which login screen should be updated with 'active' appearance
                                        }

                                        console.log('\nFrom determineWakeTimeBedTime:' +
                                                '\nWake time: ' + wakeTimeDate.toDate().toString() + '\nBed time: ' + bedTimeDate.toDate().toString());
                                    }

                                    tempReader.readAsText(file);
                                }, onFSError);
                            }, onGetDirectoryFail);
                        }, onFSError);
                    }, onFSError);
                }

                else{
                    console.log("Bed.bed NOT found");

                    bedTimeDate = defaultBedTime;
                    wakeTimeDate = defaultWakeTime;

                    timeAsleep = Math.abs(moment(bedTimeDate).diff(moment(wakeTimeDate), 'minutes'));
                    timeAsleep = Math.abs(timeAsleep - (24 * 60));

                    console.log('\nWake time: ' + wakeTimeDate.toDate().toString() + '\nBed time: ' + bedTimeDate.toDate().toString() + '\ntimeAsleep: ' + timeAsleep);
                }

                //Once we've defined bedTimeDate & wakeTimeDate, it's time to create the notifications
                if (typeof callback === "function"){
                    callback();
                }
            })
        }



        function addNewNotifications(callback){
            console.log("\naddNewNotifications");
            now = moment();

            setPartitionNotificationsForDaysV2(2, notificationCheckAndAdd);

            console.log('notificationCount: ' + notificationCount.toString());

            if (typeof callback === "function"){
                callback();
            }
        }

        /*
        //Called when last notification for the day is fired, adds 7 new notifications for the next day.
        function addNextDaysNotifications(){
            tomorrow = moment().add('days',1);

            setPartitionNotificationsForDays(tomorrow.toDate(), 1, notificationCheckAndAdd);
        }
        */

        function playNotificationAudio() {

            console.log(getPhoneGapFilePath() + 'notificationsound_3min_v2.mp3');

            my_media = new Media( getPhoneGapFilePath() + 'notificationsound_3min_v2.mp3');

            if(my_media){
                my_media.play();
                my_media.setVolume('1.0');
            }
        }

        function playAlarmAudio() {

            console.log(getPhoneGapFilePath() + 'alarm_audio_3min.mp3');

            my_alarm_media = new Media( getPhoneGapFilePath() + 'alarm_audio_3min.mp3');

            if(my_alarm_media){
                my_alarm_media.play();
                my_alarm_media.setVolume('1.0');
            }
        }


        function getPhoneGapFilePath() {

            var path = window.location.pathname;
            path = path.substr( path, path.length - 10 );
            return 'file://' + path;
        };



        //Called upon setting the waketime... will clear all notifications for that day, to be resumed at waketime set
        function setWakeTime(){
            var wScrollVal;
            var delimiter = '\n';
            var hour, minute, ampm;
            var tempWakeTime, tempBedTime; //temp date objects used for comparison between set waketime and set bedtime, before actual assignment

            wScrollVal = $("#wscroller").mobiscroll('getValue');

            hour = wScrollVal[0];
            minute = wScrollVal[1];
            ampm = wScrollVal[2];

            //In case of am or pm...
            if (ampm == '1'){
                temphour = parseInt(hour);
                temphour += 12;
                hour = temphour.toString();
            }

            tempWakeTime = moment().hour(hour).minute(minute);
            tempBedTime = moment();

            //If same day waketime is greater than same day bedtime, will cancel all notifications and create partitions from sameday waketime to next day bedtime
            //So for now, set bedtime to next day
            if(tempWakeTime.isAfter(tempBedTime)){
                //timeAsleep = moment(tempBedTime).from(tempWakeTime, true);
                timeAsleep = Math.abs(moment(tempBedTime).diff(tempWakeTime, 'minutes'));
                timeAwake = Math.abs(timeAsleep - (24 * 60));
                console.log(timeAsleep);
                tempBedTime.add('days', 1);
            }

            //If same day waketime is less than same day bedtime, will cancel all notifications, and set new partitions for next day waketime to next day bedtime
            //So for now, set bedtime to next day, as well as waketime to next day
            else if(tempBedTime.isAfter(tempWakeTime)){
                tempWakeTime.add('days', 1);

                //timeAsleep = moment(tempBedTime).from(tempWakeTime, true);
                timeAsleep = Math.abs(moment(tempBedTime).diff(tempWakeTime, 'minutes'));
                timeAwake = Math.abs(timeAsleep - (24 * 60));
                console.log(timeAsleep);
                tempBedTime.add('days', 1);
            }

            //console.log("\n*******Time asleep: " + timeAsleep.asHours());
            //console.log("\n*******Upcoming notification period:" + tempBedTime.from(tempWakeTime, true));

            //timeAsleep is number of minutes of bedtime duration
            //Must not allow user to sleep for less than minSleepTime nor sleep longer than maxSleepTime
            if((Math.abs(timeAsleep) > 60 * minSleepTime) && (Math.abs(timeAsleep) < 60 * maxSleepTime)){
                $("#waketimesubmit").attr("href","#popupWakeTime");
                currentState = states.ASLEEP;
                displayAppStatus(states.ASLEEP);

                wakeTimeDate = tempWakeTime;
                bedTimeDate = tempBedTime;

                var timesStr;
                timesStr = wakeTimeDate.toString() + delimiter + bedTimeDate.toString();

                //Test code to try out old dates within Bed.bed
                //timesStr = wakeTimeDate.subtract('days',2).toString() + delimiter + bedTimeDate.subtract('days',2).toString();

                console.log('\nupcoming hours awake:      ' + timeAwake);
                console.log('\nhours asleep:              ' + (timeAsleep / 60));
                console.log('\nnext notification period:  ' + tempBedTime.from(tempWakeTime, true));
                console.log('\nnew wake time:             ' + wakeTimeDate.toString() + '\nnew bed time: ' + bedTimeDate.toString());

                clearPriorNotifications(function(){
                    addNewNotifications(function(){
                        formNotificationString(writeToNotificationFile);
                    });
                });

                /*
                setTimeout(function(){
                    writeToWakeTimeBedTimeFile(timesStr, false);
                }, 2 * 1000);
                */
                //Need to add three minutes here for the period of time that the alarm will fire,
                //otherwise if a user enters #wakeup, leaves the app and then resumes, will be at login screen(active),
                //unable to stop alarm or choose wakeup or snooze
                resumeTime = moment().add('minutes', timeAsleep + 3);

                //Set notification at time which alarm will wake user up:
                window.plugin.notification.local.add({
                    id:         -99,
                    date:       moment(resumeTime).subtract('minutes', 3).toDate(),
                    message:    "Tap to wake up or snooze",
                    title:      'Application wake up',
                    autoCancel: false,
                    sound:      null,
                    json:       JSON.stringify({ date: moment(resumeTime).subtract('minutes', 3).toString()})
                });

                setLoginStatusLabel("Notifications will resume: " + moment(resumeTime).subtract('minutes', 3).format("MMM D, h:mm a"));

                $.mobile.navigate('#login');
            }

            else if(Math.abs(timeAsleep) < 60 * minSleepTime){
                alert("Your bedtime must not be shorter than " + minSleepTime + " hours");
                $("#popupWakeTime").popup("close");
                //$("#wscroller").val('');

            }
            else if (Math.abs(timeAsleep) > 60 * maxSleepTime){
                alert("Your bedtime must not be longer than " + maxSleepTime + " hours");
                $("#popupWakeTime").popup("close");
                //$("#wscroller").val('');

            }
        }

        function readUserID(encrypted){

            var loginArr = [];

            exists('Log.log', function(value){
                if(value){
                    //console.log("Log.log FOUND");

                        window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                            var entry = fs.root;
                            entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                                directory.getFile('Log.log', null, function(fe){
                                    //console.log('within readFromFile getFile()');
                                    var content;

                                    if(!encrypted){

                                        fe.file(function(file){
                                        //console.log('within readFromFile file()');
                                            var reader = new FileReader();

                                            reader.onloadend = function(evt){
                                                //console.log("Read as text");
                                                content = evt.target.result;
                                                //console.log(content);

                                                loginArr = content.split(delimiter);
                                                userID = loginArr[0];
                                                console.log(typeof(userID));
                                                console.log(userID.toString());
                                            }

                                            reader.readAsText(file);
                                        }, onFSError);
                                    }
                                    else{
                                        getDecryptedStringFromFileEntry(fe, function(decryptedStr){
                                            loginArr = decryptedStr.split(delimiter);

                                            userID = loginArr[0];
                                            console.log(typeof(userID));
                                            console.log(userID.toString());
                                        });
                                    }
                                }, onFSError);
                            }, onGetDirectoryFail);
                        }, onFSError);


                }

            });
        }


        //First, check if login file exists, if it does and has contents,
        function checkLoginV2(){
            //set up writing permissions:
            var fileContents;
            var loginArr = [];
            var p = $("#login-password").val();
            //check if Log.log exists, if so then read the text file and save the contents to a string

            //if admin pin entered, then navigate to admin profile
            if ($("#login-password").val() == adminPin){
                readUserID(true);
                $.mobile.navigate('#administrator');
            }

            //otherwise check user-entered pin
            else{
                exists('Log.log', function(value){

                    //if no log.log file, then must be new user
                    if(value){
                        //console.log("Log.log FOUND");

                        window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){

                            var entry = fs.root;
                            entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                                directory.getFile('Log.log', null, function(fe){
                                    //console.log('within readFromFile getFile()');

                                    //if wanting to decrypt login before comparing to user input...
                                    getDecryptedStringFromFileEntry(fe, function(decryptedStr){

                                        loginArr = decryptedStr.split(delimiter);

                                        console.log("decrypted userID: " + loginArr[0] + "\ndecrypted password: " + loginArr[1]);

                                        //If user has entered correct password:
                                        if(loginArr[1] == p){

                                            userID = loginArr[0];

                                            //WHEN LOGGING IN:

                                            //if app is currently delaying a notification
                                            if(currentState == states.DELAYED){
                                                breakDelay();
                                            }

                                            //if app is currently suspended
                                            else if(currentState == states.SUSPENDED){
                                                breakSuspend();
                                            }

                                            //if app is currently asleep
                                            else if(currentState == states.ASLEEP){
                                                breakSleep();
                                            }

                                            //If user has touched notification to take RPT
                                            else if(writingToRandomPromptInt){
                                                $.mobile.navigate("#emoSurveyA");
                                            }
                                            //If user has opened app on their own
                                            else{
                                                $.mobile.navigate("#main");
                                            }


                                            $("#login-password").val('');
                                        }
                                        else if ((p == '')){
                                            alert("Must enter a password");
                                            //$("#login-button").attr("href","#login");
                                            $.mobile.navigate('#login');
                                            $("#login-password").val('');
                                        }
                                        else{
                                            alert("Incorrect login information");
                                            //$("#login-button").attr("href","#login");
                                            $.mobile.navigate('#login');
                                            $("#login-password").val('');
                                        }
                                    });

                                }, onGetDirectoryFail);
                            }, onFSError);
                        }, onFSError);

                    }
                    //if no Log.log file, create it, and write the contents of the two input fields to the text file-  userID, password
                    else{
                        //showNewUserLoginScreen();
                        //console.log("Log.log NOT FOUND");

                        alert("Please enter new user information");
                        $.mobile.navigate("#login-newuser");
                    }
                });
            }
        }



        //Set state to active, cancel next notification
        function breakDelay(){
            currentState = states.ACTIVE;
            displayAppStatus(states.ACTIVE);

            writingToRandomPromptInt = true;
            startedRandomPromptSurvey = true;
            finishedRandomPromptSurvey = false;

            $.mobile.navigate("#emoSurveyA");

            window.plugin.notification.local.cancel(0);
        }

        function breakSuspend(){
            currentState = states.ACTIVE;
            displayAppStatus(states.ACTIVE);

            writingToRandomPromptInt = false;
            $.mobile.navigate("#main");

            clearPriorNotifications(function(){
                addNewNotifications(function(){
                    formNotificationString(writeToNotificationFile);
                });
            });
        }

        function breakSleep(){
            currentState = states.ACTIVE;
            displayAppStatus(states.ACTIVE);

            writingToRandomPromptInt = false;
            $.mobile.navigate("#main");



            clearPriorNotifications(function(){
                addNewNotifications(function(){
                    formNotificationString(writeToNotificationFile);
                });
            });
        }
        /*
        //First, check if login file exists, if it does and has contents,
        function checkLogin(loginEncrypted){
            //set up writing permissions:
            var fileContents;
            var loginArr = [];
            var p = $("#login-password").val();
            //check if Log.log exists, if so then read the text file and save the contents to a string

            if ($("#login-password").val() == adminPin){
                readUserID(true);
                $.mobile.navigate('#administrator');
            }
            else{
                exists('Log.log', function(value){
                    if(value){
                        //console.log("Log.log FOUND");

                        window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                            var entry = fs.root;
                            entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                                directory.getFile('Log.log', null, function(fe){
                                    //console.log('within readFromFile getFile()');
                                    var content;

                                    if(!loginEncrypted){
                                        fe.file(function(file){
                                            //console.log('within readFromFile file()');
                                            var reader = new FileReader();

                                            reader.onloadend = function(evt){
                                                //console.log("Read as text");
                                                content = evt.target.result;
                                                //console.log(content);

                                                loginArr = content.split(delimiter);

                                                if(loginArr[1] == p){
                                                    //$("#login-button").attr("href","#main");
                                                    //$(':mobile-pagecontainer').pagecontainer('change',
                                                    userID = loginArr[0];

                                                    //If user logs in while app is 'asleep', need to wake up app...
                                                    //change display to cancel sleep appearnace, and change bedtime/waketime and
                                                    //Create all ner notifications
                                                    if(moment().isAfter(bedTimeDate)){
                                                        displayAppStatus(states.ACTIVE);
                                                        wakeTimeDate = moment().hours(0).minutes(0).seconds(0);
                                                        bedTimeDate = moment().hours(23).minutes(59).seconds(0);

                                                        console.log("\ndefault WT: " + wakeTimeDate.format("dddd, MMMM Do YYYY, HH:mm:ss a"));
                                                        console.log("\ndefault BT: " + bedTimeDate.format("dddd, MMMM Do YYYY, HH:mm:ss a"));

                                                        timeAsleep = 1;
                                                        clearPriorNotifications(addNewNotifications);
                                                        writeToWakeTimeBedTimeFile(wakeTimeDate.toString() + '\n' + bedTimeDate.toString())
                                                    }

                                                    if(!writingToRandomPromptInt && !currentlyDelaying)
                                                        $.mobile.navigate('#main');

                                                    //In case of currently delaying a notification, but logging in to break the delay and take a survey:
                                                    else if(currentlyDelaying){
                                                        startRandomPromptInterview();
                                                    }
                                                    else
                                                        startRandomPromptInterview();

                                                    $("#login-password").val('');
                                                }
                                                else if ((p == '')){
                                                    alert("Must enter a password");
                                                    //$("#login-button").attr("href","#login");
                                                    $.mobile.navigate('#login');
                                                    $("#login-password").val('');
                                                }
                                                else{
                                                    alert("Incorrect login information");
                                                    //$("#login-button").attr("href","#login");
                                                    $.mobile.navigate('#login');
                                                    $("#login-password").val('');
                                                }
                                            }

                                            reader.readAsText(file);

                                        }, onFSError);
                                    }

                                    //if wanting to decrypt login before comparing to user input...
                                    else{
                                        getDecryptedStringFromFileEntry(fe, function(decryptedStr){

                                            loginArr = decryptedStr.split(delimiter);

                                            console.log("decrypted userID: " + loginArr[0] + "\ndecrypted password: " + loginArr[1]);

                                            if(loginArr[1] == p){
                                                //$("#login-button").attr("href","#main");
                                                //$(':mobile-pagecontainer').pagecontainer('change',
                                                userID = loginArr[0];

                                                //If user logs in while app is 'asleep', need to wake up app...
                                                //change display to cancel sleep appearnace, and change bedtime/waketime and
                                                //Create all ner notifications
                                                if(moment().isAfter(bedTimeDate)){
                                                    displayAppStatus(states.ACTIVE);
                                                    wakeTimeDate = moment().hours(0).minutes(0).seconds(0);
                                                    bedTimeDate = moment().hours(23).minutes(59).seconds(0);

                                                    console.log("\ndefault WT: " + wakeTimeDate.format("dddd, MMMM Do YYYY, HH:mm:ss a"));
                                                    console.log("\ndefault BT: " + bedTimeDate.format("dddd, MMMM Do YYYY, HH:mm:ss a"));

                                                    timeAsleep = 1;
                                                    clearPriorNotifications(addNewNotifications);
                                                    writeToWakeTimeBedTimeFile(wakeTimeDate.toString() + '\n' + bedTimeDate.toString())
                                                }

                                                if(!writingToRandomPromptInt && !currentlyDelaying)
                                                    $.mobile.navigate('#main');

                                                //In case of currently delaying a notification, but logging in to break the delay and take a survey:
                                                else if(currentlyDelaying){
                                                    startRandomPromptInterview();
                                                }
                                                else
                                                    startRandomPromptInterview();

                                                $("#login-password").val('');
                                            }
                                            else if ((p == '')){
                                                alert("Must enter a password");
                                                //$("#login-button").attr("href","#login");
                                                $.mobile.navigate('#login');
                                                $("#login-password").val('');
                                            }
                                            else{
                                                alert("Incorrect login information");
                                                //$("#login-button").attr("href","#login");
                                                $.mobile.navigate('#login');
                                                $("#login-password").val('');
                                            }
                                        });
                                    }
                                }, onGetDirectoryFail);
                            }, onFSError);
                        }, onFSError);

                    }
                //if no Log.log file, create it, and write the contents of the two input fields to the text file-  userID, password
                    else{
                    //showNewUserLoginScreen();
                        //console.log("Log.log NOT FOUND");

                        alert("Please enter new user information");
                        $.mobile.navigate("#login-newuser");
                    }
                });
            }
        }
        */


        /*
        function encryptFileWithAES(file, fileWriter){

            var reader = new FileReader();

            reader.onload = function(e){
                var encrypted = CryptoJS.AES.encrypt(e.target.result, encryptionKey);

                fileWriter.seek(0);
                fileWriter.write(encrypted);
                fileWriter.onwriteend = function(){
                    console.log("finished encrypting " + file.Name)
                }
            }

            reader.readAsDataURL(file);
        }
        */

        function encryptStringWithAES(passedString){
            var encryptedStr = CryptoJS.AES.encrypt(passedString, encryptionKey);

            return encryptedStr;
        }

        function getDecryptedStringFromFileEntry(fileEntry, callback){

            fileEntry.file(function(file){
                var content, decrypted, decryptedStr;
                var reader = new FileReader();

                reader.onloadend = function(e){
                    content = e.target.result;

                    decrypted = cryptWithCaesar(content, true);
                    decryptedStr = decrypted.toString();
                    console.log(decryptedStr);

                    if(typeof(callback === 'function')){
                        callback(decryptedStr);
                    }
                }
                reader.readAsText(file);

            }, onFSError);

        }


        /* old method uses AES
        //returns a decrypted string version of encrypted filecontents
        function getDecryptedStringFromFileEntry(fileEntry, callback){

            fileEntry.file(function(file){
                var content, decrypted, decryptedStr;
                var reader = new FileReader();

                reader.onloadend = function(e){
                    content = e.target.result;

                    decrypted = CryptoJS.AES.decrypt(content, encryptionKey);
                    decryptedStr = decrypted.toString(CryptoJS.enc.Utf8)
                    console.log(decryptedStr);

                    if(typeof(callback === 'function')){
                        callback(decryptedStr);
                    }
                }
                reader.readAsText(file);

            }, onFSError);

        }
        */



        function cryptFileWithCaesar(fileEntry, doDecrypt){

            fileEntry.file(function(file){

                console.log("Checkpoint 10 passed, fileEntry type:" + typeof(fileEntry));

                var content, crypted;
                var reader = new FileReader();

                reader.onloadend = function(e){
                    console.log("Checkpoint 11 reader has finished loading");
                    content = e.target.result;

                    console.log("contents of " + file.name + ": " + content);

                    cryptWithCaesar(content, doDecrypt, function(crypted){

                        console.log("Checkpoint 12, decrypted content: " + crypted.toString());
                        fileEntry.createWriter(function(writer){
                            console.log("Checkpoint 13, created writer");
                            writer.seek(0);

                            //console.log('within randomPromptIntfile createwriter()');
                            writer.write(crypted.toString());

                            writer.onwriteend = function(evt){
                                console.log('\nCheckpoint 14 Wrote to file ' + fileEntry.fullPath);
                            }
                        },onFSError);

                        //generalWriteToFile(decrypted, fileName, false, false);
                        //generalWriteToFile(decrypted.toString(CryptoJS.enc.Utf8), file.name, userID.toString(), false, false);
                    });
                }
                reader.readAsText(file);
            }, onFSError);

        }


        //Works!
        //
        function decryptFileWithAES(fileName, containingDir, callback){
            console.log("Checkpoint 9, in decryptFileWithAES")
            if(typeof(fileName)==="string"){
                console.log("passed fileName is a string");

                window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                    var entry = fileSystem.root;
                    entry.getDirectory(containingDir, {create: true, exclusive: false}, function(directory){

                        directory.getFile(fileName, {create: false, exclusive: false}, function(fileEntry){
                            console.log('@decrypt Within getFile(), ' + fileEntry.name);

                            fileEntry.file(function(file){
                                var content, decrypted;
                                var reader = new FileReader();

                                reader.onloadend = function(e){
                                    content = e.target.result;
                                    decrypted = CryptoJS.AES.decrypt(content, encryptionKey);
                                    //decrypted = CryptoJS.AES.decrypt(content.split(/\s/).join(''), encryptionKey);

                                    //console.log("decrypted raw: " + decrypted);
                                    console.log("decrypted string contents: " + decrypted.toString(CryptoJS.enc.Utf8));

                                    //generalWriteToFile(decrypted, fileName, false, false);
                                    generalWriteToFile(decrypted.toString(CryptoJS.enc.Utf8), fileName, false, false);
                                }

                                reader.readAsText(file);
                            }, onFSError)
                        }, onGetDirectoryFail);
                    }, onFSError)
                }, onFSError)
            }
            //Else, if passing a fileEntry object...converts to file object here:
            else{

                var fileEntry = fileName;
                fileEntry.file(function(file){

                    console.log("Checkpoint 10 passed fileName is not a string, but a " + typeof(fileEntry));

                    var content, decrypted;
                    var reader = new FileReader();

                    reader.onloadend = function(e){
                        console.log("Checkpoint 11 reader has finished loading");
                        content = e.target.result;

                        console.log("encrypted contents of " + file.name + ": " + content);
                        decrypted = CryptoJS.AES.decrypt(content, encryptionKey);

                        console.log("Checkpoint 12, decrypted content: " + decrypted.toString(CryptoJS.enc.Utf8));
                        fileEntry.createWriter(function(writer){
                            console.log("Checkpoint 13, created writer");
                            writer.seek(0);

                            //console.log('within randomPromptIntfile createwriter()');
                            writer.write(decrypted.toString(CryptoJS.enc.Utf8));

                            writer.onwriteend = function(evt){
                                console.log('\nCheckpoint 14 Wrote to file ' + fileEntry.fullPath);
                            }

                        },onFSError);

                        //generalWriteToFile(decrypted, fileName, false, false);
                        //generalWriteToFile(decrypted.toString(CryptoJS.enc.Utf8), file.name, userID.toString(), false, false);
                    }

                    reader.readAsText(file);
                }, onFSError);
            }

            if(typeof(callback)==='function'){
                callback();
            }

        }

        function exists(fileName, callback) {
            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0,function(fs){
                var entry = fs.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile(fileName,
                        {create : false},
                        function() {callback(true);
                        //console.log(fileName + " exists!");
                        },
                        function() {callback(false);
                        //console.log(fileName + " does NOT exist!");
                        });
                }, onGetDirectoryFail);
            }, onFSError)
        }

        function onFSError(err) {
            console.log("WITHIN onFSERROR()");
            console.log(err.code);
        }

        function onGetDirectoryFail(error) {
            console.log("Error creating directory "+error.code);
        }




        function writeToNotificationFile(passedString, doEncrypt){
            console.log("writeToNotificationFile()");
            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){

                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Not.not", {create: true, exclusive: false}, function(fileEntry){

                        //console.log("FILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){

                            notificationFileWriter = writer;
                            notificationFileWriter.seek(0);
                            //console.log('within notificationfile createwriter()');
                            notificationFileWriter.write(passedString);
                            notificationFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to Not.not!");
                                //console.log('\ntimes written to notifications.txt: \n' + passedString);
                            }
                        },onFSError);
                    },onFSError);
                }, onGetDirectoryFail);
            }, onFSError);
        }

        function writeToMissedNotificationsFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            //console.log('missedNotifications: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){

                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Mis.mis", {create: true, exclusive: false}, function(fileEntry){
                        //console.log("FILEENTRY.NAME: " + fileEntry);

                        fileEntry.createWriter(function(writer){
                            missedNotificationsFileWriter = writer;
                            missedNotificationsFileWriter.seek(writer.length);
                            //console.log('within missednotificationsfile createwriter()');
                            missedNotificationsFileWriter.write(passedString);
                            missedNotificationsFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to missednotifications.txt!");
                                console.log('\nWrote to Mis.mis: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }

        function writeToLoginFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            console.log('login: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){


                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Log.log", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            loginFileWriter = writer;
                            loginFileWriter.seek(0);
                            //console.log('within loginfile createwriter()');
                            loginFileWriter.write(passedString);
                            loginFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to Log.log!");
                                console.log('wrote to login file: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }

        function writeToProblemFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            console.log('Problem: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Prb.prb", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            ProblemFileWriter = writer;
                            ProblemFileWriter.seek(0);
                            //console.log('within Problemfile createwriter()');
                            ProblemFileWriter.write(passedString);
                            ProblemFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to suspend.txt!");
                                console.log('Wrote to prb.prb: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }

        function writeToWakeTimeBedTimeFile(passedString, doEncrypt){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            //console.log('waketimebedtime: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Bed.bed", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry.toString());
                        fileEntry.createWriter(function(writer){
                            wakeTimeBedTimeFileWriter = writer;
                            wakeTimeBedTimeFileWriter.seek(0);
                            //console.log('within wakeTimeBedTimefile createwriter()');
                            wakeTimeBedTimeFileWriter.write(passedString);
                            wakeTimeBedTimeFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to Bed!");
                                console.log('\nwrote to Bed.bed: \n' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);
        }




        function writeToTobaccoUseIntFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Tob.tob", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            TobaccoUseIntFileWriter = writer;
                            TobaccoUseIntFileWriter.seek(writer.length);
                            //console.log('within TobaccoUseIntfile createwriter()');
                            TobaccoUseIntFileWriter.write(passedString);
                            TobaccoUseIntFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to Tob.tob!");
                                console.log('\nwrote to tobacco use interview survey: \n' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            if(typeof(callback) === 'function')
                callback();
        }

        function writeToRandomPromptIntFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                //passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
                passedString = cryptWithCaesar(passedString, false);
            }

            console.log("randompromptint: " + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;
                entry.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.getFile("Rpt.rpt", {create: true, exclusive: false}, function(fileEntry){
                        //console.log("FILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){
                            randomPromptIntFileWriter = writer;
                            randomPromptIntFileWriter.seek(writer.length);
                            //console.log('within randomPromptIntfile createwriter()');
                            randomPromptIntFileWriter.write(passedString);
                            randomPromptIntFileWriter.onwriteend = function(evt){
                                //alert(evt);
                                //console.log("Done writing to randomPromptInt.txt!");
                                console.log('wrote to randomPromptInt: ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            callback();
        }

        function copyFile(entry, callback) {

            var fileName = entry.name;
            var fileType = fileName.split('.').pop();


            console.log("Checkpoint 4 @copyFile fileName: " + fileName);
            console.log("file type: " + fileType);
            /*
            var parent = document.getElementById('parent').value,
                    parentName = parent.substring(parent.lastIndexOf('/')+1),
                    parentEntry = new DirectoryEntry(parentName, parent);
                    */

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
                console.log("checkpoint 5, got FileSystem within copyFile");

                fs.root.getDirectory("alt", {create: true, exclusive: false}, function(dr){
                    console.log("checkPoint 6, got directory ...");

                    dr.getDirectory(userID.toString(), {create:true, exclusive: false}, function(userDir){
                        console.log("checkPoint 7, got directory " + userDir.fullPath);

                        entry.copyTo(userDir, userID.toString() + "." + fileType, function(newFileEntry){
                            console.log("checkpoint 8 copied successfully, renamed to: " + newFileEntry.name);

                            newFileEntry.file(function(f){
                                console.log("copied file " +  f.name + " size: " + f.size);
                            }, function(err){
                                console.log("copied fileENtry to file() err: " + err);
                            });

                            if (typeof(callback) === 'function')
                                callback(newFileEntry);

                        }, onFSError);
                    }, onGetDirectoryFail);
                },onGetDirectoryFail);
            }, onFSError);
        };

        /*
        function writeToNotificationFile(passedString, doEncrypt){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("Not.not", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                    fileEntry.createWriter(function(writer){
                        notificationFileWriter = writer;
                        notificationFileWriter.seek(writer.length);
                        //console.log('within notificationfile createwriter()');
                        notificationFileWriter.write(passedString);
                        notificationFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to Not.not!");
                        //console.log('\ntimes written to notifications.txt: \n' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);
        }

        function writeToMissedNotificationsFile(passedString, doEncrypt){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            //console.log('missedNotifications: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("Mis.mis", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                    fileEntry.createWriter(function(writer){
                        missedNotificationsFileWriter = writer;
                        missedNotificationsFileWriter.seek(writer.length);
                        //console.log('within missednotificationsfile createwriter()');
                        missedNotificationsFileWriter.write(passedString);
                        missedNotificationsFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to missednotifications.txt!");
                            console.log('\nWrote to Mis.mis: ' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);
        }

        function writeToLoginFile(passedString, doEncrypt){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            console.log('login: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("Log.log", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                    fileEntry.createWriter(function(writer){
                        loginFileWriter = writer;
                        loginFileWriter.seek(0);
                        //console.log('within loginfile createwriter()');
                        loginFileWriter.write(passedString);
                        loginFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to Log.log!");
                            console.log('wrote to login file: ' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);
        }

        function writeToSuspendFile(passedString, doEncrypt){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            console.log('suspend: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("suspend.txt", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                    fileEntry.createWriter(function(writer){
                        suspendFileWriter = writer;
                        suspendFileWriter.seek(0);
                        //console.log('within suspendfile createwriter()');
                        suspendFileWriter.write(passedString);
                        suspendFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to suspend.txt!");
                            console.log('Wrote to suspendfile: ' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);
        }

        function writeToWakeTimeBedTimeFile(passedString, doEncrypt){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            //console.log('waketimebedtime: ' + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("Bed.bed", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry.toString());
                    fileEntry.createWriter(function(writer){
                        wakeTimeBedTimeFileWriter = writer;
                        wakeTimeBedTimeFileWriter.seek(0);
                        //console.log('within wakeTimeBedTimefile createwriter()');
                        wakeTimeBedTimeFileWriter.write(passedString);
                        wakeTimeBedTimeFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to Bed!");
                            console.log('\nwrote to Bed.bed: ' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);
        }




        function writeToTobaccoUseIntFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("Tob.tob", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                    fileEntry.createWriter(function(writer){
                        TobaccoUseIntFileWriter = writer;
                        TobaccoUseIntFileWriter.seek(writer.length);
                        //console.log('within TobaccoUseIntfile createwriter()');
                        TobaccoUseIntFileWriter.write(passedString);
                        TobaccoUseIntFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to Tob.tob!");
                            console.log('\nwrote to tobacco use interview survey: \n' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);

            if(typeof(callback) === 'function')
                callback();
        }

        function writeToRandomPromptIntFile(passedString, doEncrypt, callback){

            if (doEncrypt){
                passedString = CryptoJS.AES.encrypt(passedString, encryptionKey).toString();
            }

            console.log("randompromptint: " + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getFile("Rpt.rpt", {create: true, exclusive: false}, function(fileEntry){
                    //console.log("FILEENTRY.NAME: " + fileEntry);
                    fileEntry.createWriter(function(writer){
                        randomPromptIntFileWriter = writer;
                        randomPromptIntFileWriter.seek(writer.length);
                        //console.log('within randomPromptIntfile createwriter()');
                        randomPromptIntFileWriter.write(passedString);
                        randomPromptIntFileWriter.onwriteend = function(evt){
                            //alert(evt);
                            //console.log("Done writing to randomPromptInt.txt!");
                            console.log('wrote to randomPromptInt: ' + passedString);
                        }
                    },onFSError);
                },onFSError);
            }, onFSError);

            callback();
        }

        */

        function generalWriteToFile(passedString, fileName, subDir, doEncrypt, doAppend, callback){

            if (doEncrypt)
                passedString = encryptStringWithAES(passedString).toString();

            console.log("passedString to general writeToFile: " + passedString);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                var entry = fileSystem.root;

                if(!subDir)
                    subDir = '';

                entry.getDirectory(".../" + subDir, {create: true, exclusive: false}, function(dir){

                    dir.getFile(fileName, {create: true, exclusive: false}, function(fileEntry){
                        //console.log("FILEENTRY.NAME: " + fileEntry);
                        fileEntry.createWriter(function(writer){

                            if (doAppend)
                                writer.seek(writer.length);
                            else
                                writer.seek(0);

                            //console.log('within randomPromptIntfile createwriter()');
                            writer.write(passedString);

                            writer.onwriteend = function(evt){
                                console.log('\nWrote to file ' + fileName + ': ' + passedString);
                            }
                        },onFSError);
                    }, onGetDirectoryFail);
                },onFSError);
            }, onFSError);

            if (typeof(callback) === 'function'){
                callback();
            }
        }

        /*
        function initializeLogin(){
            writeToLoginFile(userID + delimiter + 'password');
        } */

        function recordTimeStamp(){
            date = new Date();

            hour = date.getHours();
            min = date.getMinutes();
            sec = date.getSeconds();

            dayOfMonth = date.getDate();
            month = date.getMonth() + 1;
            year = date.getFullYear();

            timeStamp = (month + '/' + dayOfMonth + '/' + year + '_' + hour + ':' + min + ':' + sec);

            //console.log("WITHIN recordTimeStamp()");
        }

        function recordEmoSurvey(){
            emoSurveyAData.happy = $("#slider-happy").val();
            emoSurveyAData.relax = $("#slider-relax").val();
            emoSurveyAData.cheer = $("#slider-cheer").val();
            emoSurveyBData.sad = $("#slider-sad").val();
            emoSurveyBData.stress = $("#slider-stress").val();
            emoSurveyBData.angry = $("#slider-angry").val();
            emoSurveyCData.frust = $("#slider-frust").val();
            emoSurveyCData.irritbl = $("#slider-irritbl").val();
            emoSurveyCData.confdnt = $("#slider-confdnt").val();

            console.log('in recordEmoSurvey()');
        }

        function recordBEmoSurvey(){
            beforeTobEmoSurveyAData.bhappy = $("#slider-bhappy").val();
            beforeTobEmoSurveyAData.brelax = $("#slider-brelax").val();
            beforeTobEmoSurveyAData.bcheer = $("#slider-bcheer").val();
            beforeTobEmoSurveyBData.bsad = $("#slider-bsad").val();
            beforeTobEmoSurveyBData.bstress = $("#slider-bstress").val();
            beforeTobEmoSurveyBData.bangry = $("#slider-bangry").val();
            beforeTobEmoSurveyCData.bfrust = $("#slider-bfrust").val();
            beforeTobEmoSurveyCData.birritbl = $("#slider-birritbl").val();
            beforeTobEmoSurveyCData.bconfdnt = $("#slider-bconfdnt").val();

            console.log('in recordBEmoSurvey()');
        }

        function recordWhenUsingTobSurvey(){
            whenUsingTobSurveyData.pleasur = $("#slider-pleasur").val();
            whenUsingTobSurveyData.satisfy = $("#slider-satisfy").val();

            console.log('in recordWhenUsingTobSurvey()');
        }


        function recordProductUrgeSurvey(){
            productUrgeSurveyData.ulcigar = translateCheckBox($("#checkbox-ulcigar").prop('checked'));
            productUrgeSurveyData.ucigarilo = translateCheckBox($("#checkbox-ucigarilo").prop('checked'));
            productUrgeSurveyData.ubcigar = translateCheckBox($("#checkbox-ubcigar").prop('checked'));
            productUrgeSurveyData.uecig = translateCheckBox($("#checkbox-uecig").prop('checked'));
            productUrgeSurveyData.uvap = translateCheckBox($("#checkbox-uvap").prop('checked'));
            productUrgeSurveyData.uhookah = translateCheckBox($("#checkbox-uhookah").prop('checked'));
            productUrgeSurveyData.uchew = translateCheckBox($("#checkbox-uchew").prop('checked'));
            productUrgeSurveyData.udipsnf = translateCheckBox($("#checkbox-udipsnf").prop('checked'));
            productUrgeSurveyData.usnus = translateCheckBox($("#checkbox-usnus").prop('checked'));
            productUrgeSurveyData.unourge = translateCheckBox($("#checkbox-unourge").prop('checked'));
        }

        function recordCurrentActivitySurvey(){
            currentActivitySurveyData.hang =  translateCheckBox($("#checkbox-hang").prop('checked'));
            currentActivitySurveyData.tvmus =  translateCheckBox($("#checkbox-tvmus").prop('checked'));
            currentActivitySurveyData.phone =  translateCheckBox($("#checkbox-phone").prop('checked'));
            currentActivitySurveyData.texting = translateCheckBox($("#checkbox-texting").prop('checked'));
            currentActivitySurveyData.compint = translateCheckBox($("#checkbox-compint").prop('checked'));
            currentActivitySurveyData.reading = translateCheckBox($("#checkbox-reading").prop('checked'));
            currentActivitySurveyData.schl = translateCheckBox($("#checkbox-schl").prop('checked'));
            currentActivitySurveyData.job = translateCheckBox($("#checkbox-job").prop('checked'));
            currentActivitySurveyData.eatdrnk = translateCheckBox($("#checkbox-eatdrnk").prop('checked'));
            currentActivitySurveyData.alc = translateCheckBox($("#checkbox-alc").prop('checked'));
            currentActivitySurveyData.pot = translateCheckBox($("#checkbox-pot").prop('checked'));
            currentActivitySurveyData.party = translateCheckBox($("#checkbox-party").prop('checked'));
            currentActivitySurveyData.phys = translateCheckBox($("#checkbox-phys").prop('checked'));
            currentActivitySurveyData.walking = translateCheckBox($("#checkbox-walking").prop('checked'));
            currentActivitySurveyData.club = translateCheckBox($("#checkbox-club").prop('checked'));
            currentActivitySurveyData.trans = translateCheckBox($("#checkbox-trans").prop('checked'));
            currentActivitySurveyData.noth = translateCheckBox($("#checkbox-noth").prop('checked'));
            currentActivitySurveyData.other = translateCheckBox($("#checkbox-other").prop('checked'));
        }


        function setSurveyFromWOthersSurvey(){
            //Set comp's value:

            if($("#radio-comp1").prop("checked"))
                wOthersSurveyData.comp = $("#radio-comp1").val();

            else if($("#radio-comp2").prop("checked"))
                wOthersSurveyData.comp = $("#radio-comp2").val();

            else if($("#radio-comp3").prop("checked"))
                wOthersSurveyData.comp = $("#radio-comp3").val();
            
            checkboxGroupAnswered('wOthersSurvey', 'Radios', function(answered){

                //If alone:
                //Need to reset all answers within 5a (who nearby), 5a1(who family) and 5b(who tob product use) in case they answered them already and back tracked to re-
                //answer as alone
                if(wOthersSurveyData.comp == 1 && answered){
                    goto5a = false;
                    goto5a1 = false;

                    $("#locationSurveyBack").attr("href", "#wOthersSurvey");
                    $("#wOthersSurveyGo").attr("href", "#locationSurvey");

                    $("#whoNearbySurveyCheckboxes input:checked").prop("checked", false);
                    $("#whoNearbySurveyCheckboxes .check").checkboxradio("refresh");

                    $("#whoFamilySurveyCheckboxes input:checked").prop("checked", false);
                    $("#whoFamilySurveyCheckboxes .check").checkboxradio("refresh");

                    $("#nearbyProductUseSurveyCheckboxes input:checked").prop("checked", false);
                    $("#nearbyProductUseSurveyCheckboxes .check").checkboxradio("refresh");
                }

                //If not alone
                else if((wOthersSurveyData.comp == 2 || wOthersSurveyData.comp == 3)  && answered ){
                    goto5a = true;
                    goto5a1 = false;// set/reset to false for now


                    $("#locationSurveyBack").attr("href", "#nearbyProductUseSurvey");
                    $("#wOthersSurveyGo").attr("href", "#whoNearbySurvey");
                }

            });
            //console.log(tempString);
            console.log($("#wOthersSurveyGo").attr("href"));
            console.log("#locationSurveyBack:" + $("#locationSurveyBack").attr("href"));
        }

        function setSurveyFromWhoNearbySurvey(){
            if(goto5a){
                whoNearbySurveyData.alo_wthfam = translateCheckBox($("#checkbox-alo_wthfam").prop("checked"));
                whoNearbySurveyData.alo_wthpart = translateCheckBox($("#checkbox-alo_wthpart").prop("checked"));
                whoNearbySurveyData.alo_wthwork = translateCheckBox($("#checkbox-alo_wthwork").prop("checked"));
                whoNearbySurveyData.alo_wthfr = translateCheckBox($("#checkbox-alo_wthfr").prop("checked"));
                whoNearbySurveyData.alo_wthoth = translateCheckBox($("#checkbox-alo_wthoth").prop("checked"));
            }

            checkboxGroupAnswered('whoNearbySurvey', 'Checkboxes', function(answered){
                    //set go and back buttons:

                    //if near family
                    if(whoNearbySurveyData.alo_wthfam == 2 && answered){
                        goto5a1 = true;
                        //console.log("within whoNearbySurveyData.alo_wthfam == 2");
                        $("#whoNearbySurveyGo").attr("href", "#whoFamilySurvey");
                        $("#nearbyProductUseSurveyBack").attr("href", "#whoFamilySurvey");
                    }

                    //if not near family
                    else if(whoNearbySurveyData.alo_wthfam == 1 && answered){
                        //console.log("within whoNearbySurveyData.alo_wthfam == 1");
                        goto5a1 = false;

                        $("#whoNearbySurveyGo").attr("href", "#nearbyProductUseSurvey");
                        $("#nearbyProductUseSurveyBack").attr("href", "#whoNearbySurvey");

                        //Reset who family survey and nearbyProduct useSurvey answers
                        $("#whoFamilySurveyCheckboxes input:checked").prop("checked", false);
                        $("#whoFamilySurveyCheckboxes .check").checkboxradio("refresh");

                        $("#nearbyProductUseSurveyCheckboxes input:checked").prop("checked", false);
                        $("#nearbyProductUseSurveyCheckboxes .check").checkboxradio("refresh");

                    }
                    else{
                        $("#whoNearbySurveyGo").attr("href","#");
                    }
            });

            console.log("#whoNearbySurveyGo:" + $("#whoNearbySurveyGo").attr("href"));
            console.log("#nearbyProductUseSurveyBack:" + $("#nearbyProductUseSurveyBack").attr("href"));
        }



        function recordWOthersSurvey(){
            /*
            fileWriter.write(wOthersSurveyData.comp + delimiter);
            */
        }

        function recordWhoNearbySurvey(){
            if(!goto5a){
                whoNearbySurveyData.alo_wthfam = 0;
                whoNearbySurveyData.alo_wthpart = 0;
                whoNearbySurveyData.alo_wthwork = 0;
                whoNearbySurveyData.alo_wthfr = 0;
                whoNearbySurveyData.alo_wthoth = 0;
            }

        }

        function recordWhoFamilySurvey(){
            if (goto5a1){
                whoFamilySurveyData.alo_wthmom = translateCheckBox($("checkbox-alo_wthmom").prop("checked"));
                whoFamilySurveyData.alo_wthsib = translateCheckBox($("checkbox-alo_wthsib").prop("checked"));
                whoFamilySurveyData.alo_wthchild = translateCheckBox($("checkbox-alo_wthchild").prop("checked"));
                whoFamilySurveyData.alo_wthdad = translateCheckBox($("checkbox-alo_wthdad").prop("checked"));
                whoFamilySurveyData.alo_wthrel = translateCheckBox($("checkbox-alo_wthrel").prop("checked"));
            }
            else{
                whoFamilySurveyData.alo_wthmom = 0;
                whoFamilySurveyData.alo_wthsib = 0;
                whoFamilySurveyData.alo_wthchild = 0;
                whoFamilySurveyData.alo_wthdad = 0;
                whoFamilySurveyData.alo_wthrel = 0;
            }

        }

        function recordNearbyProductUseSurvey(){
            if(goto5a){
                nearbyProductUseSurveyData.ocig = translateCheckBox($("#checkbox-ocig").prop("checked"));
                nearbyProductUseSurveyData.olcigar = translateCheckBox($("#checkbox-olcigar").prop("checked"));
                nearbyProductUseSurveyData.ocigrilo = translateCheckBox($("#checkbox-ocigrilo").prop("checked"));
                nearbyProductUseSurveyData.obcigar = translateCheckBox($("#checkbox-obcigar").prop("checked"));
                nearbyProductUseSurveyData.oecig = translateCheckBox($("#checkbox-oecig").prop("checked"));
                nearbyProductUseSurveyData.ovap = translateCheckBox($("#checkbox-ovap").prop("checked"));
                nearbyProductUseSurveyData.ohookah = translateCheckBox($("#checkbox-ohookah").prop("checked"));
                nearbyProductUseSurveyData.ochew = translateCheckBox($("#checkbox-ochew").prop("checked"));
                nearbyProductUseSurveyData.odipsnf = translateCheckBox($("#checkbox-odipsnf").prop("checked"));
                nearbyProductUseSurveyData.osnus = translateCheckBox($("#checkbox-osnus").prop("checked"));
                nearbyProductUseSurveyData.onone = translateCheckBox($("#checkbox-onone").prop("checked"));
            }
            else{
                nearbyProductUseSurveyData.ocig = 0;
                nearbyProductUseSurveyData.olcigar = 0;
                nearbyProductUseSurveyData.ocigrilo = 0;
                nearbyProductUseSurveyData.obcigar = 0;
                nearbyProductUseSurveyData.oecig = 0;
                nearbyProductUseSurveyData.ovap = 0;
                nearbyProductUseSurveyData.ohookah = 0;
                nearbyProductUseSurveyData.ochew = 0;
                nearbyProductUseSurveyData.odipsnf = 0;
                nearbyProductUseSurveyData.osnus = 0;
                nearbyProductUseSurveyData.onone = 0;
            }

        }

        function recordLocationSurvey(){
            chosenValue = "";

            if($("#radio-locat31").prop("checked")){
                chosenValue = $("#radio-locat31").val();
            }
            else if ($("#radio-locat32").prop("checked")){
                chosenValue = $("#radio-locat32").val();
            }
            else if ($("#radio-locat33").prop("checked")){
                chosenValue = $("#radio-locat33").val();
            }
            else if ($("#radio-locat34").prop("checked")){
                chosenValue = $("#radio-locat34").val();
            }
            else if ($("#radio-locat35").prop("checked")){
                chosenValue = $("#radio-locat35").val();
            }
            else if ($("#radio-locat36").prop("checked")){
                chosenValue = $("#radio-locat36").val();
            }
            else if ($("#radio-locat37").prop("checked")){
                chosenValue = $("#radio-locat37").val();
            }
            else if ($("#radio-locat38").prop("checked")){
                chosenValue = $("#radio-locat38").val();
            }
            else if ($("#radio-locat39").prop("checked")){
                chosenValue = $("#radio-locat39").val();
            }
            else if ($("#radio-locat310").prop("checked")){
                chosenValue = $("#radio-locat310").val();
            }
            else if ($("#radio-locat311").prop("checked")){
                chosenValue = $("#radio-locat311").val();
            }
            else if ($("#radio-locat312").prop("checked")){
                chosenValue = $("#radio-locat312").val();
            }
            else if ($("#radio-locat313").prop("checked")){
                chosenValue = $("#radio-locat313").val();
            }
            else if ($("#radio-locat314").prop("checked")){
                chosenValue = $("#radio-locat314").val();
            }
            else if ($("#radio-locat315").prop("checked")){
                chosenValue = $("#radio-locat315").val();
            }

            locationSurveyData.locat3 = chosenValue;
        }

        function recordFirstRadioSetSurvey(){
            var temp1 = "";
            var temp2 = "";
            var temp3 = "";


            firstRadioSetSurveyData.smklocat = translateCheckBox($("#radio-smklocat2").prop("checked"));
            firstRadioSetSurveyData.antimsg = translateCheckBox($("#radio-antimsg2").prop("checked"));
            firstRadioSetSurveyData.promsg = translateCheckBox($("#radio-promsg2").prop("checked"));

        }

        function recordSecondRadioSetSurvey(){
            var temp1 = "";
            var temp2 = "";

            if($("#radio-alchour2").prop("checked")){
                temp1 = 2;
            }
            else if($("#radio-alchour1").prop("checked")){
                temp1 = 1;
            }

            if($("#radio-pothour2").prop("checked")){
                temp2 = 2;
            }
            else if($("#radio-pothour1").prop("checked")){
                temp2 = 1;
            }

            secondRadioSetSurveyData.alchour = temp1;
            secondRadioSetSurveyData.pothour = temp2;
        }

        function recordTobProductSurvey(){

            chosenValue = "";

            if($("#radio-tuproduct1").prop("checked")){
                chosenValue = $("#radio-tuproduct1").val();
            }
            else if ($("#radio-tuproduct2").prop("checked")){
                chosenValue = $("#radio-tuproduct2").val();
            }
            else if ($("#radio-tuproduct3").prop("checked")){
                chosenValue = $("#radio-tuproduct3").val();
            }
            else if ($("#radio-tuproduct4").prop("checked")){
                chosenValue = $("#radio-tuproduct4").val();
            }
            else if ($("#radio-tuproduct5").prop("checked")){
                chosenValue = $("#radio-tuproduct5").val();
            }
            else if ($("#radio-tuproduct6").prop("checked")){
                chosenValue = $("#radio-tuproduct6").val();
            }
            else if ($("#radio-tuproduct7").prop("checked")){
                chosenValue = $("#radio-tuproduct7").val();
            }
            else if ($("#radio-tuproduct8").prop("checked")){
                chosenValue = $("#radio-tuproduct8").val();
            }
            else if ($("#radio-tuproduct9").prop("checked")){
                chosenValue = $("#radio-tuproduct9").val();
            }
            else if ($("#radio-tuproduct10").prop("checked")){
                chosenValue = $("#radio-tuproduct10").val();
            }

            tobProductSurveyData.TUProduct = chosenValue;
        }

        function recordCigMentholSurvey(){
            if(gotoCigMenthol){
                if($("#radio-menthol2").prop("checked"))
                    cigMentholSurveyData.cigment = $("#radio-menthol2").val();

                else if($("#radio-menthol1").prop("checked"))
                    cigMentholSurveyData.cigment = $("#radio-menthol1").val();

            }
            else
                cigMentholSurveyData.cigment = 0;
        }



        //records random prompt notification survey
        function recordRandomPromptSurvey(){
            surveyString = '';

            recordTimeStamp();

            recordEmoSurvey();
            recordProductUrgeSurvey();
            recordCurrentActivitySurvey();
            recordWOthersSurvey();
            recordWhoNearbySurvey();
            recordWhoFamilySurvey();
            recordNearbyProductUseSurvey();
            recordLocationSurvey();
            recordFirstRadioSetSurvey();
            recordSecondRadioSetSurvey();

            surveyString = (userID + delimiter +
                            timeStamp + delimiter +
                            emoSurveyAData.happy + delimiter +
                            emoSurveyAData.relax + delimiter +
                            emoSurveyAData.cheer + delimiter +
                            emoSurveyBData.sad + delimiter +
                            emoSurveyBData.stress + delimiter +
                            emoSurveyBData.angry + delimiter +
                            emoSurveyCData.frust + delimiter +
                            emoSurveyCData.irritbl + delimiter +
                            emoSurveyCData.confdnt + delimiter +
                            productUrgeSurveyData.ulcigar + delimiter +
                            productUrgeSurveyData.ucigarilo + delimiter +
                            productUrgeSurveyData.ubcigar + delimiter +
                            productUrgeSurveyData.uecig + delimiter +
                            productUrgeSurveyData.uvap + delimiter +
                            productUrgeSurveyData.uhookah + delimiter +
                            productUrgeSurveyData.uchew + delimiter +
                            productUrgeSurveyData.udipsnf + delimiter +
                            productUrgeSurveyData.usnus + delimiter +
                            productUrgeSurveyData.unourge + delimiter +
                            currentActivitySurveyData.hang + delimiter +
                            currentActivitySurveyData.tvmus + delimiter +
                            currentActivitySurveyData.phone + delimiter +
                            currentActivitySurveyData.texting + delimiter +
                            currentActivitySurveyData.compint + delimiter +
                            currentActivitySurveyData.reading + delimiter +
                            currentActivitySurveyData.schl + delimiter +
                            currentActivitySurveyData.job + delimiter +
                            currentActivitySurveyData.eatdrnk + delimiter +
                            currentActivitySurveyData.alc + delimiter +
                            currentActivitySurveyData.pot + delimiter +
                            currentActivitySurveyData.party + delimiter +
                            currentActivitySurveyData.phys + delimiter +
                            currentActivitySurveyData.walking + delimiter +
                            currentActivitySurveyData.club + delimiter +
                            currentActivitySurveyData.trans + delimiter +
                            currentActivitySurveyData.noth + delimiter +
                            currentActivitySurveyData.other + delimiter +
                            wOthersSurveyData.comp + delimiter +
                            whoNearbySurveyData.alo_wthfam + delimiter +
                            whoNearbySurveyData.alo_wthpart + delimiter +
                            whoNearbySurveyData.alo_wthwork + delimiter +
                            whoNearbySurveyData.alo_wthfr + delimiter +
                            whoNearbySurveyData.alo_wthoth + delimiter +
                            whoFamilySurveyData.alo_wthmom + delimiter+
                            whoFamilySurveyData.alo_wthsib + delimiter +
                            whoFamilySurveyData.alo_wthchild + delimiter +
                            whoFamilySurveyData.alo_wthdad + delimiter +
                            whoFamilySurveyData.alo_wthrel  + delimiter +
                            nearbyProductUseSurveyData.ocig + delimiter +
                            nearbyProductUseSurveyData.olcigar + delimiter +
                            nearbyProductUseSurveyData.ocigrilo + delimiter +
                            nearbyProductUseSurveyData.obcigar + delimiter +
                            nearbyProductUseSurveyData.oecig + delimiter +
                            nearbyProductUseSurveyData.ovap + delimiter +
                            nearbyProductUseSurveyData.ohookah + delimiter +
                            nearbyProductUseSurveyData.ochew + delimiter +
                            nearbyProductUseSurveyData.odipsnf + delimiter +
                            nearbyProductUseSurveyData.osnus + delimiter +
                            nearbyProductUseSurveyData.onone + delimiter +
                            locationSurveyData.locat3 + delimiter +
                            firstRadioSetSurveyData.smklocat + delimiter +
                            firstRadioSetSurveyData.antimsg + delimiter +
                            firstRadioSetSurveyData.promsg + delimiter +
                            secondRadioSetSurveyData.alchour + delimiter +
                            secondRadioSetSurveyData.pothour);


            if(!takingTestSurvey){
                writeToRandomPromptIntFile(surveyString + '\n', true, function(){
                    resetSurveyWidgets();
                    alert("Thank you for filling out a survey!");
            });
            }
            else{
                resetSurveyWidgets();
                alert("Thank you for taking a demo survey. This input will NOT be recorded.");
            }


            //writeToRandomPromptIntFile(surveyString + '\n', false, resetSurveyWidgets);

            writingToRandomPromptInt = false;
            takingTestSurvey = false;

            //notificationCheckAndAdd();
            //addNotificationNow();
        }

        function recordTobaccoUseInterviewSurvey(){
            surveyString = '';

            recordTimeStamp();

            recordTobProductSurvey();
            recordCigMentholSurvey();
            recordEmoSurvey();
            recordWhenUsingTobSurvey();
            recordCurrentActivitySurvey();
            recordWOthersSurvey();
            recordWhoNearbySurvey();
            recordWhoFamilySurvey();
            recordNearbyProductUseSurvey();
            recordLocationSurvey();
            recordFirstRadioSetSurvey();
            recordSecondRadioSetSurvey();
            recordBEmoSurvey();


            surveyString = (userID + delimiter +
                            timeStamp + delimiter +
                            tobProductSurveyData.TUProduct + delimiter +
                            cigMentholSurveyData.cigment + delimiter +
                            emoSurveyAData.happy + delimiter +
                            emoSurveyAData.relax + delimiter +
                            emoSurveyAData.cheer + delimiter +
                            emoSurveyBData.sad + delimiter +
                            emoSurveyBData.stress + delimiter +
                            emoSurveyBData.angry + delimiter +
                            emoSurveyCData.frust + delimiter +
                            emoSurveyCData.irritbl + delimiter +
                            emoSurveyCData.confdnt + delimiter +
                            whenUsingTobSurveyData.pleasur + delimiter +
                            whenUsingTobSurveyData.satisfy + delimiter +
                            currentActivitySurveyData.hang + delimiter +
                            currentActivitySurveyData.tvmus + delimiter +
                            currentActivitySurveyData.phone + delimiter +
                            currentActivitySurveyData.texting + delimiter +
                            currentActivitySurveyData.compint + delimiter +
                            currentActivitySurveyData.reading + delimiter +
                            currentActivitySurveyData.schl + delimiter +
                            currentActivitySurveyData.job + delimiter +
                            currentActivitySurveyData.eatdrnk + delimiter +
                            currentActivitySurveyData.alc + delimiter +
                            currentActivitySurveyData.pot + delimiter +
                            currentActivitySurveyData.party + delimiter +
                            currentActivitySurveyData.phys + delimiter +
                            currentActivitySurveyData.walking + delimiter +
                            currentActivitySurveyData.club + delimiter +
                            currentActivitySurveyData.trans + delimiter +
                            currentActivitySurveyData.noth + delimiter +
                            currentActivitySurveyData.other + delimiter +
                            wOthersSurveyData.comp + delimiter +
                            whoNearbySurveyData.alo_wthfam + delimiter +
                            whoNearbySurveyData.alo_wthpart + delimiter +
                            whoNearbySurveyData.alo_wthwork + delimiter +
                            whoNearbySurveyData.alo_wthfr + delimiter +
                            whoNearbySurveyData.alo_wthoth + delimiter +
                            whoFamilySurveyData.alo_wthmom + delimiter+
                            whoFamilySurveyData.alo_wthsib + delimiter +
                            whoFamilySurveyData.alo_wthchild + delimiter +
                            whoFamilySurveyData.alo_wthdad + delimiter +
                            whoFamilySurveyData.alo_wthrel  + delimiter +
                            nearbyProductUseSurveyData.ocig + delimiter +
                            nearbyProductUseSurveyData.olcigar + delimiter +
                            nearbyProductUseSurveyData.ocigrilo + delimiter +
                            nearbyProductUseSurveyData.obcigar + delimiter +
                            nearbyProductUseSurveyData.oecig + delimiter +
                            nearbyProductUseSurveyData.ovap + delimiter +
                            nearbyProductUseSurveyData.ohookah + delimiter +
                            nearbyProductUseSurveyData.ochew + delimiter +
                            nearbyProductUseSurveyData.odipsnf + delimiter +
                            nearbyProductUseSurveyData.osnus + delimiter +
                            nearbyProductUseSurveyData.onone + delimiter +
                            locationSurveyData.locat3 + delimiter +
                            firstRadioSetSurveyData.smklocat + delimiter +
                            firstRadioSetSurveyData.antimsg + delimiter +
                            firstRadioSetSurveyData.promsg + delimiter +
                            secondRadioSetSurveyData.alchour + delimiter +
                            secondRadioSetSurveyData.pothour + delimiter +
                            beforeTobEmoSurveyAData.bhappy + delimiter +
                            beforeTobEmoSurveyAData.brelax + delimiter +
                            beforeTobEmoSurveyAData.bcheer + delimiter +
                            beforeTobEmoSurveyBData.bsad + delimiter +
                            beforeTobEmoSurveyBData.bstress + delimiter +
                            beforeTobEmoSurveyBData.bangry + delimiter +
                            beforeTobEmoSurveyCData.bfrust + delimiter +
                            beforeTobEmoSurveyCData.birritbl + delimiter +
                            beforeTobEmoSurveyCData.bconfdnt + delimiter );

            writeToTobaccoUseIntFile(surveyString+ '\n', true, function(){
                resetSurveyWidgets();
                alert("Thank you for completing a tobacco use interview!")
                    });
        }

        function startRandomPromptInterview(){
            startedRandomPromptSurvey = true;
            finishedRandomPromptSurvey = false;

            $.mobile.navigate("#login");

            $(document).on('pagebeforeshow', '#emoSurveyA', function(){
                $('#emoSurveyABack').prop('disabled', true).addClass('ui-disabled');
            });
            $("#emoSurveyABack").attr('href', '#');

            writingToRandomPromptInt = true;

            $("#secondRadioSetSurveyGo .ui-btn-text").text("Submit survey");
        }

        function startTobaccoUseInterview(){
            //console.log("within startTobaccoUseInterview()");

            $(document).on('pagebeforeshow', '#emoSurveyA', function(){
                // So we can test if button is disabled or not
                $('#emoSurveyABack').prop('disabled', false).removeClass('ui-disabled');
            });

            $.mobile.navigate("#tobProductSurvey");
            writingToRandomPromptInt = false;

            $("#secondRadioSetSurveyGo .ui-btn-text").text("Next");
        }

        function finishEmoSurveyA(){
            if(($("#slider-happy").val() != '') && ($("#slider-relax").val() != '') && ($("#slider-cheer").val() != '')){
                $("#emoSurveyAGo").attr("href", "#emoSurveyB");
                visitedEmoSurveyA = true;
            }

            else
                $("#emoSurveyAGo").attr("href", "#");
        }


        function finishEmoSurveyB(){
            if(($("#slider-sad").val() != '') && ($("#slider-stress").val() != '') && ($("#slider-angry").val() != '')){
                $("#emoSurveyBGo").attr("href", "#emoSurveyC");
                visitedEmoSurveyB = true;
            }
            else
                $("#emoSurveyBGo").attr("href", "#");

        }


        function finishEmoSurveyC(){
            if(($("#slider-frust").val() != '') && ($("#slider-irritbl").val() != '') && ($("#slider-confdnt").val() != '')){
                if(writingToRandomPromptInt)
                    $("#emoSurveyCGo").attr("href", "#productUrgeSurvey");

                else
                    $("#emoSurveyCGo").attr("href", "#whenUsingTobSurvey");

                visitedEmoSurveyC = true;
            }
            else
                $("#emoSurveyCGo").attr("href", "#");

        }

        //finish Before Tobacco Enotional Surveys:

        function finishBeforeTobEmoSurveyA(){
            if(($("#slider-bhappy").val() != '') && ($("#slider-brelax").val() != '') && ($("#slider-bcheer").val() != '')){
                $("#beforeTobEmoSurveyAGo").attr("href", "#beforeTobEmoSurveyB");
                visitedBeforeTobEmoSurveyA=true;
            }

            else
                $("#beforeTobEmoSurveyAGo").attr("href", "#");

            console.log($("#slider-bhappy").val() +
                        $("#slider-brelax").val() +
                        $("#slider-bcheer").val());



        }

        function finishBeforeTobEmoSurveyB(){
            if(($("#slider-bsad").val() != '') && ($("#slider-bstress").val() != '') && ($("#slider-bangry").val() != '')){
                $("#beforeTobEmoSurveyBGo").attr("href", "#beforeTobEmoSurveyC");
                visitedBeforeTobEmoSurveyB=true;
            }
            else
                $("#beforeTobEmoSurveyBGo").attr("href", "#");

            console.log( $("#slider-bsad").val() +
                        $("#slider-bstress").val() +
                        $("#slider-bangry").val());
        }

        //Last page of TUI survey
        function finishBeforeTobEmoSurveyC(){
            if(($("#slider-bfrust").val() != '') && ($("#slider-birritbl").val() != '') && ($("#slider-bconfdnt").val() != '')){
                $("#beforeTobEmoSurveyCGo").attr("href", "#main");
                visitedBeforeTobEmoSurveyC=true;
                recordTobaccoUseInterviewSurvey();
            }
            else
                $("#beforeTobEmoSurveyCGo").attr("href", "#");

            console.log($("#slider-bfrust").val()+
                    $("#slider-birritbl").val()+
                    $("#slider-bconfdnt").val());


        }

        function finishWhenUsingTobSurvey(){
            if(($("#slider-pleasur").val() != '') && ($("#slider-satisfy").val() != '')){
                $("#whenUsingTobSurveyGo").attr("href", "#currentActivitySurvey");
                $("#currentActivitySurveyBack").attr("href", "#whenUsingTobSurvey");
                visitedWhenUsingTobSurvey = true;
            }
            else{
                $("#whenUsingTobSurveyGo").attr("href", "#");
            }
        }


        function finishProductUrgeSurvey(){
            //console.log("\nwritingToRandomPromptInt: " + writingToRandomPromptInt);
            checkboxGroupAnswered('productUrgeSurvey', 'Checkboxes', function(answered){
                if(answered){
                    if(writingToRandomPromptInt){
                        console.log("\nanswered a checkbox");
                        $("#productUrgeSurveyGo").attr('href', '#currentActivitySurvey');
                        $("#currentActivitySurveyBack").attr('href','#productUrgeSurvey')
                    }
                }
                else{
                    console.log("\ndid not answer a checkbox");
                    $("#productUrgeSurveyGo").attr('href', '#');
                }

                console.log("\n productUrgeSurveyGo href: " + $("#productUrgeSurveyGo").attr('href'));
            });
        }


        function finishCurrentActivitySurvey(){
            checkboxGroupAnswered('currentActivitySurvey', 'Checkboxes', function(answered){
                if(answered){
                    $("#currentActivitySurveyGo").attr('href', '#wOthersSurvey');
                }
                else{
                    $("#currentActivitySurveyGo").attr('href', '#');
                }
                console.log("\n currentActivitySurveyGo href: " + $("#currentActivitySurveyGo").attr('href'));
            })

        }



        function finishWhoFamilySurvey(){
            checkboxGroupAnswered('whoFamilySurvey', 'Checkboxes', function(answered){
                if(answered){
                    $("#whoFamilySurveyGo").attr('href', '#nearbyProductUseSurvey');
                }
                else{
                    $("#whoFamilySurveyGo").attr('href', '#');
                }
                console.log("\n whoFamilySurveyGo href: " + $("#whoFamilySurveyGo").attr('href'));
            });
        }

        function finishNearbyProductUseSurvey(){
            checkboxGroupAnswered('nearbyProductUseSurvey', 'Checkboxes', function(answered){
                if(answered){
                    console.log("\nanswered a checkbox");
                    $("#nearbyProductUseSurveyGo").attr('href', '#locationSurvey');
                    //$.mobile.navigate("#currentActivitySurvey');
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#nearbyProductUseSurveyGo").attr('href', '#');
                }

                console.log("\n nearbyProductUseSurveyGo href: " + $("#nearbyProductUseSurveyGo").attr('href'));
            });
        }

        function finishLocationSurvey(){
            checkboxGroupAnswered('locationSurvey', 'Radios', function(answered){
                if(answered){
                    console.log("\nanswered a radio");
                    $("#locationSurveyGo").attr('href', '#firstRadioSetSurvey');
                    //$.mobile.navigate("#currentActivitySurvey');
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#locationSurveyGo").attr('href', '#');
                }

                console.log("\n locationSurveyGo href: " + $("#locationSurveyGo").attr('href'));
            });

        }

        function finishFirstRadioSetSurvey(){
            /*
            checkboxGroupAnswered('firstRadioSetSurvey', 'Radios', function(answered){
                if(answered){
                    console.log("\nanswered a radio");
                    $("#firstRadioSetSurveyGo").attr('href', '#secondRadioSetSurvey');
                    //$.mobile.navigate("#currentActivitySurvey');
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#firstRadioSetSurveyGo").attr('href', '#');
                }

                console.log("\n #firstRadioSetSurveyGo href: " + $("#firstRadioSetSurveyGo").attr('href'));
            });
            */
            var answered1 = false;
            var answered2 = false;
            var answered3 = false;



            if($("#radio-smklocat2").prop("checked")){
                answered1 = true;
            }
            else if($("#radio-smklocat1").prop("checked")){
                answered1 = true;
            }


            if($("#radio-antimsg2").prop("checked")){
                answered2 = true;
            }
            else if($("#radio-antimsg1").prop("checked")){
                answered2 = true;
            }


            if($("#radio-promsg2").prop("checked")){
                answered3 = true;
            }
            else if($("#radio-promsg1").prop("checked")){
                answered3 = true;
            }



            if(answered1 && answered2 && answered3){
                console.log("\nanswered all radios");
                $("#firstRadioSetSurveyGo").attr('href', '#secondRadioSetSurvey');
            }
            else{
                console.log("\ndid not answer all checkboxes");
                $("#firstRadioSetSurveyGo").attr('href', '#');
            }
        }

        function finishSecondRadioSetSurvey(){
            /*
            checkboxGroupAnswered('secondRadioSetSurvey', 'Radios', function(answered){
                if(answered){

                    if(writingToRandomPromptInt){
                        console.log("\nanswered a radio");
                        $("#secondRadioSetSurveyGo").attr('href', '#');
                        recordAllSurvey();
                        //$.mobile.navigate("#currentActivitySurvey');
                    }
                    else{
                        console.log("\nanswered a radio");
                        $("#secondRadioSetSurveyGo").attr('href', '#beforeTobEmoSurveyA');
                    }
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#secondRadioSetSurveyGo").attr('href', '#');
                }

                console.log("\n #secondRadioSetSurvey href: " + $("#secondRadioSetSurveyGo").attr('href'));
            });
            */
            var answered1 = false;
            var answered2 = false;

            if($("#radio-alchour2").prop("checked")){
                answered1 = true;
            }
            else if($("#radio-alchour1").prop("checked")){
                answered1 = true;
            }

            if($("#radio-pothour2").prop("checked")){
                answered2 = true;
            }
            else if($("#radio-pothour1").prop("checked")){
                answered2 = true;
            }

            if(answered1 && answered2){
                if(writingToRandomPromptInt){

                    //Criteria for not registering as 'abdndoned survey'
                    hasMissedNotification = false;
                    missedNotifications = 0;
                    finishedRandomPromptSurvey = true;
                    startedRandomPromptSurvey = false;

                    console.log("\nanswered all radios");
                    //$("#secondRadioSetSurveyGo").attr('href', '#main');
                    $.mobile.navigate("#main");
                    recordRandomPromptSurvey();

                    //$.mobile.navigate("#currentActivitySurvey');
                }
                else{
                    console.log("\nanswered all radios");
                    $.mobile.navigate("#beforeTobEmoSurveyA");
                    //$("#secondRadioSetSurveyGo").attr('href', '#beforeTobEmoSurveyA');
                }
            }
            else{
                console.log("\ndid not answer all checkboxs");
                $("#secondRadioSetSurveyGo").attr('href', '#');
            }

        }

        function finishTobProductSurvey(){
            var chosenValue = "";

            checkboxGroupAnswered('tobProductSurvey', 'Radios', function(answered){
                if(answered){
                    if($("#radio-tuproduct1").prop("checked")){

                       gotoCigMenthol = true;
                       $("#tobProductSurveyGo").attr('href', '#cigMentholSurvey');
                       $("#emoSurveyABack").attr('href', '#cigMentholSurvey');
                    }

                    //if not chosen cigarette...
                    //Change back and go buttons to correct anchors
                    //In case of a user initially choosing cigarette, then choosing menthol or not, then reverseing to
                    //choose a product other than cigarette, need to change the menthol widgets to clear
                    else{
                       gotoCigMenthol = false;
                       $("#tobProductSurveyGo").attr('href', '#emoSurveyA');
                       $("#emoSurveyABack").attr('href', '#tobProductSurvey');

                       $("#cigMentholSurveyRadios input:checked").prop("checked", false);
                       $("#cigMentholSurveyRadios .radio").checkboxradio("refresh");
                    }
                    //Need to set text for question 3... when using tobacco...


                    if($("#radio-tuproduct1").prop("checked")){
                        chosenValue = "Cigarette";
                    }
                    else if ($("#radio-tuproduct2").prop("checked")){
                        chosenValue = "Little Cigar";
                    }
                    else if ($("#radio-tuproduct3").prop("checked")){
                        chosenValue = "Cigarillo";
                    }
                    else if ($("#radio-tuproduct4").prop("checked")){
                        chosenValue = "Big Cigar";
                    }
                    else if ($("#radio-tuproduct5").prop("checked")){
                        chosenValue = "e-cigarette";
                    }
                    else if ($("#radio-tuproduct6").prop("checked")){
                        chosenValue = "Vaporizer";
                    }
                    else if ($("#radio-tuproduct7").prop("checked")){
                        chosenValue = "Hookah";
                    }
                    else if ($("#radio-tuproduct8").prop("checked")){
                        chosenValue = "Chew";
                    }
                    else if ($("#radio-tuproduct9").prop("checked")){
                        chosenValue = "Dip/Snuff";
                    }
                    else if ($("#radio-tuproduct10").prop("checked")){
                        chosenValue = "Snus";
                    }

                    $("#pleasurLabel").text("How pleasurable was the " + chosenValue + "?");
                    $("#satisfyLabel").text("How satisfying was the " + chosenValue + "?");
                }

                else{
                    console.log("\ndid not answer a checkbox");
                    $("#tobProductSurveyGo").attr('href', '#');
                }

            });

            console.log("\nChosen Value: " + chosenValue);
            console.log("\n tobProductSurveyGo href: " + $("#tobProductSurveyGo").attr('href')
                      + "\n emoSurveyABack href:     " + $("#emoSurveyABack").attr('href'));
        }



        function finishCigMentholSurvey(){
            checkboxGroupAnswered('cigMentholSurvey', 'Radios', function(answered){

                if(answered){
                    $("#cigMentholSurveyGo").attr("href", "#emoSurveyA")
                }
                else{
                    $("#cigMentholSurveyGo").attr("href", "#");
                }

            });
            console.log("\n cigMentholSurveyGo href: " + $("#cigMentholSurveyGo").attr('href'));

        }



        //translates passed string of checkbox to needed data value... on, undefined ---> 2, 1
        function translateCheckBox(passedChecked){

           //console.log('\n' + 'Checkbox ' + checkboxCount.toString() + ' ' + passedChecked);
           if(passedChecked){
               return '2';
           }
           else{
               return '1';
           }

        }

        function checkboxGroupAnswered(id, type, callback){
            var answer;
            var n = $( "#" + id + type +" input:checked" ).length;
            console.log("\n" + n + " checked checkboxes");

            if(n != 0){
                answer = true;
            }
            else{
                answer = false;
            }



            if (typeof(callback) === 'function'){
                callback(answer);
            }
        }




        function randomMoment(mStart, mEnd) {
            var dStart, dEnd;
            dStart = mStart.toDate();
            dEnd = mEnd.toDate();

            var randMoment, tempDate;

            tempDate = new Date(dStart.getTime() + Math.random() * (dEnd.getTime() - dStart.getTime()));
            randMoment = moment(tempDate);

            //console.log(randMoment.format());

            return randMoment;
        }


        //This function uses moment.js:
        //Populates partitionTimes only!!   Does not actually add notifications!
        //Need to have waketime and bedtimes decided before here!
        //This version only adds an absence of notifications for the first period of timeAsleep, afterward, adds notifications throughout
        // the next day
        function setPartitionNotificationsForDaysV2(numDays, callback){
            console.log("\nsetPartitionNotificationsForDaysV2()");
            //Will always subtract bedtime from waketime, as bedtime will always come after waketime
            //var partitionAmt = Math.abs((bedTimeDate.toDate() - wakeTimeDate.toDate())) / surveysInADay;
            var tempTimeAsleep = Number(timeAsleep);
            var tempTimeAwake = Number(timeAwake);

            var partitionAmt = Math.abs((tempTimeAwake * 60 * 1000)) / surveysInADay;

            partitionaAmt = Math.round(Math.abs(partitionAmt));

            //console.log("Partition amount during first wake period:      " + partitionAmt);

            //didMissNotificationArr = [];
            //partitionTimes = [];

            //var oldMoment = moment(passedDate).hours(wakeTimeDate.hours()).minutes(wakeTimeDate.minutes());
            //var newMoment = moment(oldMoment).add('milliseconds', partitionAmt);

            var oldMoment = moment(wakeTimeDate);
            var newMoment = moment(oldMoment).add('milliseconds', partitionAmt);

            var randMoment;

            var bufferedOldMoment, bufferedNewMoment;


            for(var i = 0; i < (parseInt(numDays) * surveysInADay); i++){

                //Every time we reach the max number of surveys in a day, start over and partition notifications for the next day
                if(i % surveysInADay == 0 && i != 0 && (i != (parseInt(numDays) * surveysInADay))){

                    //console.log('\noldMoment: ' + moment(oldMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a"))
                    //console.log('timeAsleep: ' + timeAsleep);
                    tempTimeAsleep = 1;
                    tempTimeAwake =  Math.abs(tempTimeAsleep - 24 * 60);

                    partitionAmt =  Math.round(Math.abs((24 * 60 * 60 * 1000) / surveysInADay));
                    //console.log("Partition amount after first wake period: " + partitionAmt);
                    oldMoment.add('minutes', tempTimeAsleep);
                    //console.log('\noldMoment after adding timeAsleep: ' + moment(oldMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a"));

                    newMoment = moment(oldMoment).add('milliseconds', partitionAmt);
                    //console.log('\nnewMoment from oldMoment: ' + moment(newMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a") );
                }

                bufferedOldMoment = oldMoment.clone().add('minutes', bufferMins);
                bufferedNewMoment = newMoment.clone().subtract('minutes', bufferMins)

                randMoment = randomMoment(bufferedOldMoment, bufferedNewMoment);

                //console.log('\n' + randMoment.toDate().toString());

                partitionTimes.push(randMoment);
                didMissNotificationArr.push(true);

                oldMoment = newMoment;
                newMoment = moment(newMoment);
                newMoment.add('milliseconds', partitionAmt);
            }

            //console.log('\nend of setPartitionNotifications()');

            if (typeof(callback) === 'function'){
                callback();
            }
        }

        /*
        //This function uses moment.js:
        //Populates partitionTimes only!!   Does not actually add notifications!
        //Need to have waketime and bedtimes decided before here!
        function setPartitionNotificationsForDays(numDays, callback){

            //Will always subtract bedtime from waketime, as bedtime will always come after waketime
            var partitionAmt = Math.abs((bedTimeDate.toDate() - wakeTimeDate.toDate())) / surveysInADay;
            partitionaAmt = Math.round(Math.abs(partitionAmt));

            //console.log("Partition amount: " + partitionAmt);

            //didMissNotificationArr = [];
            //partitionTimes = [];

            //var oldMoment = moment(passedDate).hours(wakeTimeDate.hours()).minutes(wakeTimeDate.minutes());
            //var newMoment = moment(oldMoment).add('milliseconds', partitionAmt);

            var oldMoment = moment(wakeTimeDate);
            var newMoment = moment(oldMoment).add('milliseconds', partitionAmt);

            var randMoment;

            var bufferedOldMoment, bufferedNewMoment;


            for(var i = 0; i < (parseInt(numDays) * surveysInADay); i++){

                //Every time we reach the max number of surveys in a day, start over and partition notifications for the next day
                if(i % surveysInADay == 0 && i != 0 && (i != (parseInt(numDays) * surveysInADay))){

                    //console.log('\noldMoment: ' + moment(oldMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a"))
                    //console.log('timeAsleep: ' + timeAsleep);

                    oldMoment.add('minutes', timeAsleep);
                    //console.log('\noldMoment after adding timeAsleep: ' + moment(oldMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a"));

                    newMoment = moment(oldMoment).add('milliseconds', partitionAmt);
                    //console.log('\nnewMoment from oldMoment: ' + moment(newMoment).format("dddd, MMMM Do YYYY, HH:mm:ss a") );
                }

                bufferedOldMoment = oldMoment.clone().add('minutes', bufferMins);
                bufferedNewMoment = newMoment.clone().subtract('minutes', bufferMins)

                randMoment = randomMoment(bufferedOldMoment, bufferedNewMoment);

                //console.log('\n' + randMoment.toDate().toString());

                partitionTimes.push(randMoment);
                didMissNotificationArr.push(true);

                oldMoment = newMoment;
                newMoment = moment(newMoment);
                newMoment.add('milliseconds', partitionAmt);
            }

            //console.log('\nend of setPartitionNotifications()');

            if (typeof(callback) === 'function'){
                callback();
            }

        }
        */

        //traverse notificationtimes, for all times that are greater than the current time,
        //add notificaitons at those times
        function notificationCheckAndAdd(){
            console.log("\nnotificationCheckAndAdd()");

            //reset timeAsleep and timeAwake here, so that if we need to repopulate notifications, it will do that for 24 hour period, not base don timeAwake
            timeAsleep = 1;
            timeAwake = Math.abs(timeAsleep - (24 * 60));

            //Same reason as above... need to reset variables so that repopulating notifications after this will populate for 24 hour period
            wakeTimeDate = moment(defaultWakeTime);
            bedTimeDate = moment(defaultBedTime);

            var tempMoment;
            var now = moment();

            //console.log("\nWithin notificationCheckAndAdd()\nAdded:");

            for(var i = 0; i < partitionTimes.length; i++){
                tempMoment = moment(partitionTimes[i]);

                if(tempMoment.isAfter(now)){
                    notificationCount += 1;
                    notificationTimes.push(tempMoment);
                    addNotificationAtTime(tempMoment.toDate(), notificationCount);
                    //if(notificationCount <= 5)
                        //console.log('\nAdded #' + notificationCount + ' @' + tempMoment.format('dddd, MMMM Do, HH:mm:ss a'));
                    //break;
                }
            }

            //There may be an instance where no notifications will be added for a day... when setting the waketime, will also set bedtime
            //as current time, therefore no more notificaitons for that day...
            if (notificationCount == 0){
                console.log("\nNOTIFICATION COUNT = 0");
                //clearPriorNotifications(addNewNotifications);
                //formNotificationString(writeToNotificationFile);
            }
        }

        function addNotificationAtTime(passedDate, passedNo, callback){
            //notifyDateObj = Date.parse(passedStringDate);
            var tempDate = new Date(passedDate);
            var tempStr = tempDate.toString();

            window.plugin.notification.local.add({
                id:         passedNo,
                date:       tempDate,
                message:    "Tap to take a survey",
                title:      'Random prompt notification',
                autoCancel: true,
                sound:      null,
                json:       JSON.stringify({ date: tempStr}),
                badge:      parseInt(passedNo)
            });

            //console.log('\nadded notification ' + passedNo.toString() + ' @ ' + tempStr);

            if(typeof(callback) === 'function'){
                callback();
            }
        }


        function addToMissedNotifications(missType, passedDateString){
            var now = moment();
            var concatStr;

            missedNotifications += 1;

            //concatStr = missType.toString() + delimiter + missedNotifications.toString() + delimiter + now.toDate().toString();
            concatStr = missType.toString() + delimiter + missedNotifications.toString() + delimiter + passedDateString + '\n';
            writeToMissedNotificationsFile(concatStr);
        }


        function formNotificationString(callback){
            console.log("\nformNotificationString()");
            var concatString='';

            for(var i = 0; i < partitionTimes.length; i++){
                concatString += partitionTimes[i].toDate();
                concatString += '\n';
            }

            if(typeof(callback) === 'function'){
                callback(concatString, false);
            }
        }

        function isWithinBounds(value,min, max){
            if((value >= min) && (value <= max)){
                return true;
            }
            else{
                return false;
            }
        }

        /*
        function randomDate(start, end) {
            return new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()))
        }
        */


        function randRange (min, max) {
            return Math.random() * (max - min) + min;
        }

        function checkNewLoginInfo(){
            var tempName, tempName2, tempPass, tempPass2;
            var namesMatch, passesMatch;
            var correctPassSyntax = false;

            tempName = $("#login-newuser-username").val();
            tempName2 = $("#login-newuser-username2").val();
            tempPass = $("#login-newuser-password").val();
            tempPass2 = $("#login-newuser-password2").val();

            namesMatch = (tempName == tempName2);
            passesMatch = (tempPass == tempPass2);

            if(tempPass.length == 4)
                correctPassSyntax = true;

            if(!correctPassSyntax){
                alert("Password must be 4-digits long");
                $("#login-newuser-username").val('');
                $("#login-newuser-username2").val('');
                $("#login-newuser-password").val('');
                $("#login-newuser-password2").val('');
            }
            else if(!namesMatch){
                alert("Usernames must match");
                $("#login-newuser-username").val('');
                $("#login-newuser-username2").val('');
                $("#login-newuser-password").val('');
                $("#login-newuser-password2").val('');
            }
            else if(!passesMatch){
                alert("Passwords must match");
                $("#login-newuser-username").val('');
                $("#login-newuser-username2").val('');
                $("#login-newuser-password").val('');
                $("#login-newuser-password2").val('');
            }
            else if((namesMatch && passesMatch) && correctPassSyntax){
                alert("New user successfully created");
                writeToLoginFile(tempName + delimiter + tempPass, true);
                $.mobile.navigate("#login");
            }
        }

        function resetSurveyWidgets(){
            //console.log("Within resetSurveyWidgets()");

            visitedEmoSurveyA = false;
            visitedEmoSurveyB = false;
            visitedEmoSurveyC = false;

            visitedBeforeTobEmoSurveyA = false;
            visitedBeforeTobEmoSurveyB = false;
            visitedBeforeTobEmoSurveyC = false;

            visitedWhenUsingTobSurvey = false;

            takingTestSurvey = false;

            gotoCigMenthol = false;

            $(".jquerymobileslider").val(null).slider("refresh").val(null).change();
            $(".jquerymobileslidercont .ui-slider-handle").css("left", "50%");

            $(".check").prop('checked', false).checkboxradio('refresh');
            $(".radio").prop('checked', false).checkboxradio('refresh');
        }

        function determineWhichLogin(){

            exists("Log.log", function(result){
                if(result){
                    //$.mobile.navigate('#login');
                    //("determineWhichLogin: found Log.log");
                }
                else{
                    $.mobile.navigate('#login-newuser');
                    //console.log("determineWhichLogin: NOT found Log.log");
                }
            });
        }



        (function( $, undefined ) {
            $.widget( "mobile.slider", $.mobile.slider, {
                options: {
                    popupEnabled: false,
                    showValue: false
                },
                _create: function() {
                    var o = this.options,
                            popup = $( "<div></div>", {
                                class: "ui-slider-popup ui-shadow ui-corner-all ui-body-" + ( o.theme ? o.theme : $.mobile.getInheritedTheme( this.element, "c" ) )
                            });
                    this._super();
                    $.extend( this, {
                        _currentValue: null,
                        _popup: popup,
                        _popupVisible: false,
                        _handleText: this.handle.find( ".ui-btn-text" )
                    });
                    this.slider.before( popup );
                    popup.hide();
                    this._on( this.handle, { "vmousedown" : "_showPopup" } );
                    this._on( this.slider.add( $.mobile.document ), { "vmouseup" : "_hidePopup" } );
                    this._refresh();
                },
                // position the popup centered 5px above the handle
                _positionPopup: function() {
                    var dstOffset = this.handle.offset();
                    this._popup.offset( {
                        left: dstOffset.left + ( this.handle.width() - this._popup.width() ) / 2,
                        top: dstOffset.top - this._popup.outerHeight() - 5
                    });
                },
                _setOption: function( key, value ) {
                    this._super( key, value );
                    if ( key === "showValue" ) {
                        if ( value ) {
                            this._handleText.html( this._value() ).show();
                        } else {
                            this._handleText.hide();
                        }
                    }
                },
                // show value on the handle and in popup
                refresh: function() {
                    this._super.apply( this, arguments );
                    // necessary because slider's _create() calls refresh(), and that lands
                    // here before our own _create() has even run
                    if ( !this._popup ) {
                        return;
                    }
                    this._refresh();
                },
                _refresh: function() {
                    var o = this.options, newValue;
                    if ( o.popupEnabled ) {
                        // remove the title attribute from the handle (which is
                        // responsible for the annoying tooltip); NB we have
                        // to do it here as the jqm slider sets it every time
                        // the slider's value changes :(
                        this.handle.removeAttr( 'title' );
                    }
                    newValue = this._value();
                    if ( newValue === this._currentValue ) {
                        return;
                    }
                    this._currentValue = newValue;
                    if ( o.popupEnabled ) {
                        this._positionPopup();
                        this._popup.html( newValue );
                    }
                    if ( o.showValue ) {
                        this._handleText.html( newValue );
                    }
                },
                _showPopup: function() {
                    if ( this.options.popupEnabled && !this._popupVisible ) {
                        this._handleText.hide();
                        this._popup.show();
                        this._positionPopup();
                        this._popupVisible = true;
                    }
                },
                _hidePopup: function() {
                    if ( this.options.popupEnabled && this._popupVisible ) {
                        this._handleText.show();
                        this._popup.hide();
                        this._popupVisible = false;
                    }
                }
            });
        })( jQuery );

        function fireExampleNotification(){
            window.plugin.notification.local.add({
                id:         -1,
                message:    "Tap here to take a survey",
                title:      'Random prompt notification',
                autoCancel: true,
                sound:      null,
                badge:      -1
            });
        }

        function addNotificationsNow(){
            var now                  = new Date(),
                _15_seconds_from_now = new Date(now.getTime() + 15*1000),
                _30_seconds_from_now = new Date(_15_seconds_from_now.getTime() + 15*1000),
                _45_seconds_from_now = new Date(_30_seconds_from_now.getTime() + 15*1000);

            notificationCount = notificationCount + 1;

            window.plugin.notification.local.add({
                id:         notificationCount,
                message:    now.toString(),
                title:      'Random prompt notification',
                badge:      1,
                //sound:      notificationSoundLoc,
                autoCancel: true
            });
            console.log('\nfirst notification @ ' + now.toString());

            notificationCount = notificationCount + 1;
            window.plugin.notification.local.add({
                id:         notificationCount,
                date:       _15_seconds_from_now,
                message:    _15_seconds_from_now.toString(),
                title:      'Random prompt notification',
                badge:      15,
                //sound:      notificationSoundLoc,
                autoCancel: true
            });
            console.log('\nsecond notification @ ' + _15_seconds_from_now.toString());

            notificationCount = notificationCount + 1;
            window.plugin.notification.local.add({
                id:         notificationCount,
                date:       _30_seconds_from_now,
                message:    _30_seconds_from_now.toString(),
                title:      'Random prompt notification',
                badge:      30,
                //sound:      notificationSoundLoc,
                autoCancel: true
            });
            console.log('\nthird notification @ ' + _30_seconds_from_now.toString());

            notificationCount = notificationCount + 1;
            window.plugin.notification.local.add({
                id:         notificationCount,
                date:       _45_seconds_from_now,
                message:    _45_seconds_from_now.toString(),
                title:      'Random prompt notification',
                repeat:     'daily',
                badge:      45,
                //sound:      notificationSoundLoc,
                autoCancel: true
            });
            console.log('\nfourth notification @ ' + _45_seconds_from_now.toString())
        }

        function cryptWithCaesar(passedString, doDecrypt, callback){

            var result = doCrypt(doDecrypt, passedString);

            if(typeof(callback) === 'function')
                callback(result);
            else
                return result;

        }

        //Decrypts all the output files, renames all of the files to userName_fileType.txt, and moves them from '...' to
        //a new directory within '.alt' named userName
        function prepareAllFiles(){
            var fileNames = new Array("Tob.tob", "Rpt.rpt", "Log.log", "Bed.bed", "Mis.mis", "Not.not");

            clearPriorNotifications();
            if(my_media){
                my_media.stop();
                //my_media.reset();
                my_media.release();
            }

            displayAppStatus(states.ACTIVE);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    console.log("Checkpoint 1");

                    exists(fileNames[2], function(value){
                        if(value){
                            console.log("Checkpoint 2, " + fileNames[2] + " found.");

                            directory.getFile(fileNames[2], {create: false, exclusive: false}, function(fileEntry){
                                console.log("Checkpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry, function(copiedFileEntry){
                                    //decryptFileWithAES(copiedFileEntry)

                                    cryptFileWithCaesar(copiedFileEntry, true);

                                });
                            }, onFSError);
                        }
                        //else
                            //console.log(fileNames[2] + " not found!");
                    });

                    exists(fileNames[3], function(value){
                        if(value){
                            console.log("Checkpoint 2, " + fileNames[3] + " found.");

                            directory.getFile(fileNames[3], {create: false, exclusive: false}, function(fileEntry){
                                console.log("Checkpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);
                                copyFile(fileEntry);

                            }, onFSError);
                        }
                        //else
                            //console.log(fileNames[3] + " not found!");
                    });

                    exists(fileNames[4], function(value){
                        if(value){
                            console.log("Checkpoint 2, " + fileNames[4] + " found.");

                            directory.getFile(fileNames[4], {create: false, exclusive: false}, function(fileEntry){
                                console.log("Checkpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry);
                            }, onFSError);
                        }
                        //else
                            //console.log(fileNames[4] + " not found!");
                    });

                    exists(fileNames[5], function(value){
                        if(value){
                            console.log("Checkpoint 2, " + fileNames[5] + " found.");

                            directory.getFile(fileNames[5], {create: false, exclusive: false}, function(fileEntry){
                                console.log("Checkpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry);
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[4] + " not found!");
                    });

                    //First, encrypted files
                    exists(fileNames[0], function(value){
                        if(value){
                            console.log("Checkpoint 2, " + fileNames[0] + " found.");

                            directory.getFile(fileNames[0], {create: false, exclusive: false}, function(fileEntry){
                                console.log("Checkpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry, function(copiedFileEntry){
                                    //decryptFileWithAES(copiedFileEntry)

                                    cryptFileWithCaesar(copiedFileEntry, true);
                                });
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[0] + " not found!");
                    });


                    exists(fileNames[1], function(value){
                        if(value){
                            console.log("Checkpoint 2, " + fileNames[1] + " found.");

                            directory.getFile(fileNames[1], {create: false, exclusive: false}, function(fileEntry){
                                console.log("Checkpoint 3 @prepareAllFiles(), got file, FILEENTRY.NAME: " + fileEntry.name);

                                copyFile(fileEntry, function(copiedFileEntry){
                                    //decryptFileWithAES(copiedFileEntry)
                                    cryptFileWithCaesar(copiedFileEntry, true);

                                });
                            }, onFSError);
                        }
                        //else
                        //console.log(fileNames[1] + " not found!");
                    });



                },onGetDirectoryFail);
            }, onFSError);
        }



        //Deletes all of the output files, including the newly prepared directory which holds formatted user data
        function deleteAllFiles(){

            clearPriorNotifications();
            if(my_media){
                my_media.stop();
                //my_media.reset();
                my_media.release();
            }

            displayAppStatus(states.ACTIVE);

            window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
                fileSystem.root.getDirectory("alt", {create: true, exclusive: false}, function(directory){

                    directory.removeRecursively(function(){
                        alert("You have deleted all of the user data for " + userID.toString())
                    }, function(){
                        alert("Error, user data not deleted for user " + userId.toString() + " delete the directory manually from Android file manager.");
                    });
                }, onGetDirectoryFail);
            }, onFSError);
        }


        function suspendNotifications(onResume){
            var suspendTime = parseInt($("#suspend-select1 option:selected").val());
            var suspendReason = $("#suspend-select2 option:selected").text();

            //If not cancelling a suspension:
            if(suspendTime){
                var now = moment();
                var suspendLimit = moment().add('minutes', suspendTime);
                console.log('\nadding mins:  ' + suspendTime);
                console.log('\ntime now:     ' + now.format("dddd, MMMM Do YYYY, HH:mm:ss a"));
                console.log('\nsuspendLimit: ' + suspendLimit.format("dddd, MMMM Do YYYY, HH:mm:ss a"))

                //difference between number of notifications actually added and number of notification times partitioned:
                var diff = Math.abs(notificationCount - partitionTimes.length);
                var translatedIndex;

                console.log('\nnotificationCount: ' + notificationCount);
                console.log('\nnotificationsLen:  ' + partitionTimes.length);

                console.log('\ndiff: ' + diff);

                for(var i = 0; i < partitionTimes.length; i++){

                    //notification IDs are stored by the actual count of the notification, not from the notification index of their related time
                    if (partitionTimes[i].isAfter(now) && partitionTimes[i].isBefore(suspendLimit)){
                        //translatedIndex is also the id of notification to cancel
                        console.log('\ni:    ' + i);
                        console.log('\ndiff: ' + diff);
                        translatedIndex = (i - diff) + 1;
                        console.log('\ntranslatedIndex: ' + translatedIndex);

                        window.plugin.notification.local.cancel(translatedIndex);
                    }
                }

                currentState = states.SUSPENDED;
                displayAppStatus(states.SUSPENDED);

                if(resumeTime == null)
                    resumeTime = suspendLimit;
            }

            setLoginStatusLabel("Notifications will resume: " + resumeTime.format("MMM D, h:mm a"));

            if(!onResume)
                $.mobile.navigate('#login');

        }

        function delayNotification(onResume){
            currentState = states.DELAYED;
            startedRandomPromptSurvey = false; //results in registering as abandoned == false upon resume()
            finishedRandomPromptSurvey = false;
            writingToRandomPromptInt = false; //user could run out a delayed period, have status revert to active... dont want the user to be taken immediately to random prompt upon login
            displayAppStatus(states.DELAYED);

            var delayTime = parseInt($("#select-choice-1 option:selected").val());

            if (resumeTime == null)
                resumeTime = moment().add('minutes', delayTime);

            console.log("\n@delayNotification()\nwill fire notification @ " + resumeTime.format("dddd, MMMM Do YYYY, h:mm:ss a"));

            /*
            addNotificationAtTime(resumeTime.toDate(), lastCancelledNotification);
            //In the case that you delay a notification, will need to reset the value of it being missed or not, so that
            //if user also misses the delayed notification, it will be properly recorded
            didMissNotificationArr[parseInt(lastCancelledNotification)] = true;
            */

            //Need to add a unique notification id, can't over ride prior notification id as the didMissNotificationArr[id] value
            //could be overwritten upon  trying to initialize delayed notification didMissNotificationValue, resulting in double missed
            //notification value.
            window.plugin.notification.local.add({
                id:         0,
                date:       resumeTime.toDate(),
                message:    "Tap to take a survey",
                title:      'Delayed prompt notification',
                autoCancel: true,
                sound:      null,
                json:       JSON.stringify({ date: resumeTime.toString()}),
                badge:      0
            });

            setLoginStatusLabel("Notification will resume: " + resumeTime.format("MMM D, h:mm a"));

            /*
            setTimeout(function(){
                console.log("after delaying a notification for " + delayTime + "minutes--");
                console.log("current state from: " + currentState);

                if(currentState == states.DELAYED)
                    currentState = states.ACTIVE;

                console.log("current state to: " + currentState);

            }, parseInt(delayTime) * 60 * 1000);
            */

            if(!onResume)
                $.mobile.navigate('#login');
        }

        function wakeUp(){
            //clearPriorNotifications(addNewNotifications);
            didMissWakeUp = false;
            window.plugin.notification.local.cancel(-99);
            currentState = states.ACTIVE;
            displayAppStatus(states.ACTIVE);
            $.mobile.navigate("#login");
        }

        function snooze(){
            //cancelling the alarm notification, also sets wakeUpFiring to false... no need to do it here
            didMissWakeUp = false;
            window.plugin.notification.local.cancel(-99);

            var snoozeTime = moment().add('minutes', 10);
            //Need to include 3 additional minutes for the three minute duration that the alarm goes off
            resumeTime = moment().add('minutes', 13);

            window.plugin.notification.local.add({
                id:         -99,
                date:       snoozeTime.toDate(),
                message:    "Tap to wake up or snooze",
                title:      'Application wake up',
                autoCancel: false,
                sound:      null,
                json:       JSON.stringify({ date: snoozeTime.toString()})
            });

            setLoginStatusLabel("Alarm will resume: " + snoozeTime.format("MMM D, h:mm a"));

            $.mobile.navigate("#login");
        }

        function setLoginStatusLabel(passedString){
            $("#login-statuslabel h3").text(passedString);
            console.log('Should change label to ' + passedString);
        }

        //Updates the portion below the login screen to let user know if the application is suspended, delayed, or sleeping
        function displayAppStatus(type){
            if(type == states.SUSPENDED){
                currentState = states.SUSPENDED;
                switchLoginTheme('g');

                $("#login-header h1").text("Notifications Suspended");
                $("#login-footer-header").text("Log in to break suspension");

                //console.log('\nwithin displayAppStatus(\'suspend\'');
            }
            else if(type == states.ASLEEP){
                currentState = states.ASLEEP;
                switchLoginTheme('f');

                $("#login-header h1").text("App is asleep");
                $("#login-footer-header").text("Log in to break bedtime");

                //console.log('\nwithin displayAppStatus(\'bedtime\'');
            }
            else if(type == states.DELAYED){
                currentState = states.DELAYED;
                switchLoginTheme('h');

                $("#login-header h1").text("Delaying Notification");
                $("#login-footer-header").text("Log in to take a survey now");

                //console.log('\nwithin displayAppStatus(\'delay\'');
            }

            //Cancel appStatus display
            else if(type == states.ACTIVE){
                currentState = states.ACTIVE;
                switchLoginTheme('a');

                $("#login-header h1").text("Login");
                $("#login-footer-header").text("UIC & EVL");

                $("#suspend-select1").val(30).selectmenu('refresh');
                $("#delaydiv #select-choice-1").val(5).selectmenu('refresh');

                //console.log('\nwithin displayAppStatus(\'active\'');
                setLoginStatusLabel("Receiving notifications");

                resumeTime = null;

                wakeUpFiring = false;
            }
        }

        function switchLoginTheme(passedTheme){

            //btns
            $('#login').each(function(){
                $(this).find('.ui-btn').removeClass('ui-btn-up-a ui-btn-hover-a ' +
                        'ui-btn-up-f ui-btn-hover-f ui-btn-up-g ui-btn-hover-g ' +
                        'ui-btn-up-h ui-btn-hover-h').addClass('ui-btn-up-' + passedTheme).attr('data-theme', passedTheme);
            });

            //header and footer
            $('#login').each(function(){
                $(this).find('.ui-header, .ui-footer').removeClass('ui-bar-a ' +
                        'ui-bar-f ' + 'ui-bar-g ' + 'ui-bar-h').addClass('ui-bar-' + passedTheme).attr('data-theme', passedTheme);
            });

            //page contents
            $('#login').each(function(){
                $(this).removeClass('ui-body-a ' +
                        'ui-body-f ' + 'ui-body-g ' + 'ui-body-h').addClass('ui-body-' + passedTheme).attr('data-theme', passedTheme);
            });

        }

        function setIntervalX(callback, delay, repetitions) {
            var x = 0;

            callback();

            var intervalID = window.setInterval(function () {

                callback();

                if (++x === repetitions) {
                    window.clearInterval(intervalID);
                }
            }, delay);
        }

        function setDeceleratingTimeout(callback, factor, times )
        {
            var internalCallback = function( t, counter )
            {
                return function()
                {
                    if ( t-- > 0 )
                    {
                        window.setTimeout( internalCallback, ++counter * factor );
                        callback();
                    }
                }
            }( times, 0 );

            window.setTimeout( internalCallback, factor );
        };



        function setDeceleratingTimeoutWithDuration(callback, factor, duration, partitionSize )
        {
            var times = parseInt(Math.ceil(parseInt(duration) / parseInt(partitionSize)));

            var internalCallback = function( t, counter )
            {
                return function()
                {
                    if ( t-- > 0 )
                    {
                        window.setTimeout( internalCallback, --counter * factor );
                        callback();
                    }
                }
            }( times, times );

            window.setTimeout( internalCallback, factor );
        };

        /*
        function showWakeTimeDialog(){
            $.mobile.changePage( "#dialogPageWakeTime", { role: "dialog" } );

        }



        function addTwoWeeksOfNotifications(){

        var tempMoment = moment().hours(0).minutes(0).seconds(0);

        //console.log(tempMoment);
        //console.log("tempMoment within checkAndAddTwoWeeksOfNotifications(): " + tempMoment.format("dddd, MMMM Do YYYY, h:mm:ss a"));

        for(var i = 0; i < 14; i++){
        //console.log("iteration " + i);
        if(i != 0)
        tempMoment.add('days', 1);

        //console.log("iteration " + i);
        setPartitionNotificationsForDay(tempMoment);
        }

        console.log('\n***' + partitionTimes.length + "dates within partitionTimes");

        console.log("after first for loop, BEFORE nca()");
        notificationCheckAndAdd();
        console.log('\n***' + notificationCount + " added notifications!!!");

        console.log("after first for loop, AFTER nca()");
        formNotificationString(writeToNotificationFile);
        }

         function determineEndDate(callback){
         exists('enddate.txt', function(value){
         if(value){
         console.log('enddate.txt exists');

         window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fs){
         fs.root.getFile('enddate.txt', null, function(fe){
         console.log('\nwithin readFromFile enddate getFile()');
         fe.file(function(file){
         console.log('\nwithin readFromFile enddate file()');

         var reader = new FileReader();
         var content;

         reader.onloadend = function(evt){
         console.log("\nRead as text, enddate");
         content = evt.target.result;
         console.log(content);

         enddate = moment(content);
         }
         reader.readAsText(file);

         }, onFSError);
         }, onFSError);
         }, onFSError);
         }

         //If no enddate.txt, create new date object, and write the date string to enddate.txt
         else{
         var tempDate = moment().add('days',14);
         var passedString = tempDate.toDate().toString();
         enddate = tempDate;

         window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, function(fileSystem){
         fileSystem.root.getFile("enddate.txt", {create: true, exclusive: false}, function(fileEntry){
         console.log("FILEENTRY.NAME: " + fileEntry);
         fileEntry.createWriter(function(writer){
         enddateFileWriter = writer;
         enddateFileWriter.seek(0);
         console.log('within enddate createwriter()');
         enddateFileWriter.write(passedString);
         enddateFileWriter.onwriteend = function(evt){
         //alert(evt);
         console.log("Done writing to enddate.txt!");
         }
         },onFSError);
         },onFSError);
         }, onFSError);

         }
         if (typeof callback === "function"){
         callback();
         }
         })
         }

        */

        //Test function:
        /*



        //to be called EVERY time a user clicks a notification
        function clickedOnNotification(){
            notificationCount += 1;

            if (notificationCount == 7){
                addNextDayNotifications();
                notificationCount = 0
            }
        }
        */

	</script>
<style>

    .ui-title {
        margin: 0.6em 10% 0.8em !important;
    }

    #ajaxSpinner{
        width: 100%;
        height: 100%;
        background-color:#f3f3f3;
    }

    h2{
    margin-top: 0px;
    margin-bottom: 0px;
    }

    h3{
    margin-top: 5px;
    margin-bottom: 0px;

    }

    #button-mainsurvey .ui-btn-inner {
        font-size: 20px;
    }

    #button-snooze .ui-btn-inner {
        font-size: 40px;
    }
    #button-wakeup .ui-btn-inner {
        font-size: 40px;
    }

    .jquerymobileslidercont {
        padding: 10px;
        border-bottom: 1px solid #ddd;
    }

    .jquerymobileslidercont label {
        font-weight: bold;
        font-size: 20px;
    }

    .jquerymobileslidercont .leftSpan{
        margin-left: 68px;
    }

    .jquerymobileslidercont .rightSpan{
        position: absolute;
        right: 0px;
        margin-right: 30px;
    }

    .jquerymobileslidercont .ui-slider-track {
        height: 32px;
        margin-top: -8px;
    }
    .jquerymobileslidercont .ui-slider-handle {
        height: 40px !important;
        width: 40px !important;
        margin-top: -20px !important;
        line-height: 40px;
    }
    .jquerymobileslidercont .ui-slider-handle .ui-btn-text {
        font-weight: bold;
        font-size: 18px;
    }

    .ui-header .ui-title{
        font-size: 20px;
    }

    .jquerymobileslidercont .ui-slider-handle .ui-btn-text{

        bottom: 17%;
    }

    .ui-slider .ui-btn-inner {
        padding: 5px 0 0 0 !important;
        font-size: 1.5em;
    }

    .ui-slider-popup {
        position: absolute !important;
        width: 64px;
        height: 64px;
        text-align: center;
        font-size: 36px;
        padding-top: 14px;
        z-index: 100;
        opacity: 0.8;
    }

    input .password-field{
        -webkit-text-security: disc;

    }
    /*
    #login-appstatus{
        height:50px;
        width:100%;
        background-color:#f3f3f3;
    }
    */


    /*
    label.ui-slider{
        font-size: 20px;
    }

    .ui-slider-track .ui-btn.ui-slider-handle {
        top: 30%;
    }

    .ui-slider-track {
        height: 30px;
        top: 0%;
    }

    .ui-slider-handle{
        height: 40px !important;
        width: 40px !important;
    }
    */



</style>
</head>

    <body onload="onLoad()">
        <!-- login page -->

        <div id="login" data-role="page">

            <!--div style="position:fixed" id="ajaxSpinner"><img src="img/ajax-loader.gif" style="vertical-align: middle; right: 50%;"> </div-->

            <div data-role="header" id="login-header">
                <h1>Login</h1>
            </div>

            <div data-role="content">
                <!--div id="logincontent"></div-->
                <form id="form-login">
                    <div data-role="fieldcontain" class="ui-hide-label">
                        <label for="login-password">Password:</label>
                        <input type="tel" name="login-password" id="login-password" value="" placeholder="Password" class="password-field"/>
                    </div>
                    <a href="#" id="login-button" data-role="button" onclick="checkLoginV2()">Login</a>
                    <!--a href="#" id="login-button" data-role="button" data-rel="popup" onclick="checkLoginPopUp()">Login</a-->
                </form>
                <div id="login-statuslabel">
                    <h3 align="center">Receiving notifications</h3>
                </div>

                <div id="resultMessage">None yet</div>

            </div>



            <div data-role="footer" id="login-footer" data-theme="a">
                <h4 id="login-footer-header">UIC &amp; EVL</h4>
            </div>

            <!--div data-role="popup" id="popupLogin" data-overlay-theme="a" data-theme="a" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
                <div data-role="header" data-theme="a" class="ui-corner-top">
                    <h2>Login</h2>
                </div>
                <div data-role="content" align="center" data-theme="a" class="ui-corner-bottom ui-content">
                    <h4 align="center">By setting your wake time, you are putting the application to sleep.</h4>
                    <h3 align="center">Are you sure you want to break?</h3>
                    <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="a">Cancel</a>
                    <a href="#" data-role="button" data-inline="true" data-transition="flow" onclick="checkLogin()" data-theme="a">Log in</a>
                </div>
            </div-->


        </div>


    <!-- NEW USER LOGIN PAGE -->

    <div id="login-newuser" data-role="page">

        <div data-role="header">
            <h1>New user registration</h1>
        </div>

        <div data-role="content">
            <form id="form-login-newuser">
                <div data-role="fieldcontain">
                    <label for="login-newuser-username">Enter username:</label>
                    <input type="text" name="login-newuser-username" id="login-newuser-username" value="" placeholder="Please enter desired username" />
                    <input type="text" name="login-newuser-username2" id="login-newuser-username2" value="" placeholder="Re-enter username" align="right" />
                </div>
                <div data-role="fieldcontain">
                    <label for="login-newuser-password">Enter password:</label>
                    <input type="tel" name="login-newuser-password" id="login-newuser-password" value="" placeholder="Please enter desired 4-digit password" />
                    <input type="tel" name="login-newuser-password2" id="login-newuser-password2" value="" placeholder="Re-enter password" align="right" />
                </div>
                <a href="#" id="login-newuser-button" data-role="button" onclick="checkNewLoginInfo()">Register new user</a>
            </form>
        </div>

        <div data-role="footer">
            <h4>UIC &amp; EVL</h4>
        </div>

    </div>

    <!-- DELAY PAGE -->
    <div data-role="page" id="delay">
        <header data-role="header" data-theme="h">
            <h1 align="center">Delay Notification</h1>
        </header>

        <div data-role="content">
            <div id="delaycontent"></div>
        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" class="ui-disabled">Back</a></li>
                    <li><a href="#" class="ui-disabled">Next</a></li>
                </ul>
            </div>
        </div>


    </div>

    <!--  MAIN PAGE   -->

    <div data-role="page" id="main">

        <header data-role="header" data-theme="c">
            <h1 class="main-header" align="center">Main Menu</h1>
        </header>

        <div data-role="content">
            <ul id="notelist" data-role="listview"></ul>
            <a href="#" data-role="button" data-icon="bars" id="button-mainsurvey" onclick="startTobaccoUseInterview()">Tobacco Use Interview</a>
            <a href="#suspend" data-role="button" data-icon="forward">Suspend</a>
            <a href="#wakeTime" data-role="button" data-icon="edit">Set Wake Time</a>
            <a href="#problemreport" data-role="button" data-icon="alert">Problem Report</a>
            <a href="#reference" data-role="button" data-icon="arrow-r">Reference</a>
            <!--a href="#cancel" data-role="button" data-icon="delete" onclick="exitFromApp()">Cancel</a-->
        </div>

        <div data-role="footer" data-position="fixed">
             <div data-role="navbar">
                 <ul>
                     <li><a href="#anylink" class="ui-disabled">Back</a></li>
                     <li><a href="#anylink" class="ui-disabled">Next</a></li>
                 </ul>
             </div>
        </div>

    </div>

    <!-- ADMINISTRATOR MENU -->

    <div data-role="page" id="administrator">

        <header data-role="header" data-theme="c">
            <h1 class="admin-header" align="center">Administrator Menu</h1>
        </header>

        <div data-role="content">
            <ul id="administratorlist" data-role="listview"></ul>
            <a href="#" data-role="button" data-icon="grid" onclick="prepareAllFiles()">Prepare all files</a>
            <a href="#delete1" data-role="button" data-icon="delete">Delete all files</a>
        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#anylink" class="ui-disabled">Back</a></li>
                    <li><a href="#anylink" class="ui-disabled">Next</a></li>
                </ul>
            </div>
        </div>

    </div>

    <!-- LINKED SURVEY 1a -->

    <div data-role="page" id="emoSurveyA">

        <div data-role="content">
            <div id="emoSurveyAcontent"></div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" id="emoSurveyABack">Back</a></li>
                    <li><a href="#" onclick="finishEmoSurveyA()" id="emoSurveyAGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY 1b -->

    <div data-role="page" id="emoSurveyB">

        <div data-role="content">
            <div id="emoSurveyBcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyA">Back</a></li>
                    <li><a href="#" onclick="finishEmoSurveyB()" id="emoSurveyBGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY 1c -->

    <div data-role="page" id="emoSurveyC">

        <div data-role="content">
            <div id="emoSurveyCcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyB">Back</a></li>
                    <li><a href="#" onclick="finishEmoSurveyC()" id="emoSurveyCGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>



    <!--BEFORE TOBACCO USE SLIDER PAGES -->

    <!-- LINKED SURVEY ba -->

    <div data-role="page" id="beforeTobEmoSurveyA">

        <div data-role="content">
            <div id="beforeTobEmoSurveyAcontent"></div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#secondRadioSetSurvey">Back</a></li>
                    <li><a href="#" onclick="finishBeforeTobEmoSurveyA()" id="beforeTobEmoSurveyAGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY bb -->

    <div data-role="page" id="beforeTobEmoSurveyB">

        <div data-role="content">
            <div id="beforeTobEmoSurveyBcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#beforeTobEmoSurveyA">Back</a></li>
                    <li><a href="#" onclick="finishBeforeTobEmoSurveyB()" id="beforeTobEmoSurveyBGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY bc -->

    <div data-role="page" id="beforeTobEmoSurveyC">

        <div data-role="content">
            <div id="beforeTobEmoSurveyCcontent"></div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#beforeTobEmoSurveyB">Back</a></li>
                    <li><a href="#" onclick="finishBeforeTobEmoSurveyC()" id="beforeTobEmoSurveyCGo">Submit survey</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED WHENUSINGTOBSURVEY -->

    <div data-role="page" id="whenUsingTobSurvey">

        <div data-role="content">
            <div id="whenUsingTobSurveycontent"></div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyC">Back</a></li>
                    <li><a href="#" onclick="finishWhenUsingTobSurvey()" id="whenUsingTobSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>


    <!-- LINKED SURVEY 2 -->
    <div data-role="page" id="productUrgeSurvey">

        <div data-role="content">
            <div id="productUrgeSurveyContent">
            </div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#emoSurveyC">Back</a></li>
                    <li><a href="#" id="productUrgeSurveyGo" onclick="finishProductUrgeSurvey()">Next</a></li>
                </ul>
            </div>
        </div>
    </div>


    <!-- LINKED SURVEY3 -->

    <div data-role="page" id="currentActivitySurvey">

        <div data-role="content">
            <div id="currentActivitySurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" id="currentActivitySurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishCurrentActivitySurvey()" id="currentActivitySurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>


    <!-- LINKED SURVEY4 **DEPENDENT**-->

    <div data-role="page" id="wOthersSurvey">


        <div data-role="content">
            <div id="wOthersSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#currentActivitySurvey">Back</a></li>
                    <li><a href="#" id="wOthersSurveyGo" onclick="setSurveyFromWOthersSurvey()">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY5a **DEPENDENT**-->

    <div data-role="page" id="whoNearbySurvey">


        <div data-role="content">
            <div id="whoNearbySurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#wOthersSurvey">Back</a></li>
                    <li><a href="#" id="whoNearbySurveyGo" onclick="setSurveyFromWhoNearbySurvey()">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY5a1 -->

    <div data-role="page" id="whoFamilySurvey">


        <div data-role="content">
            <div id="whoFamilySurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#whoNearbySurvey">Back</a></li>
                    <li><a href="#nearbyProductUseSurvey" onclick="finishWhoFamilySurvey()" id="whoFamilySurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY5b -->

    <div data-role="page" id="nearbyProductUseSurvey">


        <div data-role="content">
            <div id="nearbyProductUseSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <!-- Need to determine how to go back correctly -->
                    <li><a href="#" id="nearbyProductUseSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishNearbyProductUseSurvey()" id="nearbyProductUseSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY6 -->

    <div data-role="page" id="locationSurvey">


        <div data-role="content">
            <div id="locationSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" id="locationSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishLocationSurvey()" id="locationSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY 789 -->


    <div data-role="page" id="firstRadioSetSurvey">

        <div data-role="content">
            <div id="firstRadioSetSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <!-- Need to determine how to go back correctly -->
                    <li><a href="#locationSurvey" id="firstRadioSetSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishFirstRadioSetSurvey()" id="firstRadioSetSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- LINKED SURVEY 1011 -->


    <div data-role="page" id="secondRadioSetSurvey">


        <div data-role="content">
            <div id="secondRadioSetSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#firstRadioSetSurvey" id="secondRadioSetSurveyBack">Back</a></li>
                    <li><a href="#" onclick="finishSecondRadioSetSurvey()" id="secondRadioSetSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>
    </div>


    <!-- TOBPRODUCTSURVEY -->

    <div data-role="page" id="tobProductSurvey">


        <div data-role="content">
            <div id="tobProductSurveyContent">
            </div>
        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#" class="ui-disabled">Back</a></li>
                    <li><a href="#" onclick="finishTobProductSurvey()" id="tobProductSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>

    </div>


    <!-- CIGMENTHOLSURVEY -->

    <div data-role="page" id="cigMentholSurvey">

        <div data-role="content">
            <div id="cigMentholSurveyContent">
            </div>
        </div>


        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#tobProductSurvey">Back</a></li>
                    <li><a href="#" onclick="finishCigMentholSurvey()" id="cigMentholSurveyGo">Next</a></li>
                </ul>
            </div>
        </div>


    </div>



    <!-- LINKED SUSPEND PAGE -->

    <div data-role="page" id="suspend">

        <div data-role="header" data-theme="g">
            <h1>Suspend Notifications</h1>
        </div>

        <div data-role="content">
            <div id="suspendcontent" data-role="controlgroup" data-type="horizontal">

            </div>
        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#" onclick="suspendNotifications(false)">Submit suspension</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Dialog for waketime check -->
    <!--div data-role="page" id="dialogPageWakeTime" data-theme="f">
        <div data-role="header" data-theme="f">

        </div>
        <div role="main" class="ui-content" data-theme="f">



            <div align="center">
                <a href="#wakeTime" data-role="button" data-rel="back" data-inline="true" data-theme="f">Cancel</a>
                <a href="#" data-role="button" onclick="setWakeTime()" data-inline="true" data-theme="f">Put to sleep</a>
            </div>
        </div>
    </div-->

    <!--a href="#popupWakeTime" data-rel="popup" data-position-to="window" data-role="button" data-inline="true" data-transition="pop" data-icon="delete" data-theme="b">Delete page...</a-->


    <!-- LINKED WAKETIME PAGE -->

    <div data-role="page" id="wakeTime">

        <div data-role="header" data-theme="f">
            <h1>Wake Time</h1>
        </div>

        <div data-role="content">
            <div id="wakeTimecontent">
                <!--  bedTime content here... collapsible sets -->
            </div>
        </div>



        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#popupWakeTime" id="waketimesubmit" data-transition="pop" data-position-to="window" data-rel="popup">Submit wake time</a></li>
                </ul>
            </div>
        </div>

        <div data-role="popup" id="popupWakeTime" data-overlay-theme="f" data-theme="f" data-dismissible="false" style="max-width:400px;" class="ui-corner-all">
            <div data-role="header" data-theme="f" class="ui-corner-top">
                <h2>Put application to sleep?</h2>
            </div>
            <div data-role="content" align="center" data-theme="f" class="ui-corner-bottom ui-content">
                <h4 align="center">By setting your wake time, you are putting the application to sleep.</h4>
                <h3 align="center">Are you sure you want to continue?</h3>
                <a href="#" data-role="button" data-inline="true" data-rel="back" data-theme="a">Cancel</a>
                <a href="#" data-role="button" data-inline="true" data-transition="flow" onclick="setWakeTime()" data-theme="f">Put to sleep</a>
            </div>
        </div>

    </div>



    <!-- LINKED PROBLEM REPORT -->

    <div data-role="page" id="problemreport">

        <div data-role="header" data-theme="e">
            <h1>Problem Report</h1>
        </div>

        <div data-role="content">
            <div id="problemreportcontent"></div>
        </div>



        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#main">Submit report</a></li>
                </ul>
            </div>
        </div>
    </div>


    <!-- LINKED DEMO PAGE -->

    <div data-role="page" id="reference">

        <div data-role="header" data-theme="e">
            <h1>Reference Page</h1>
        </div>

        <div data-role="content">
            <div id="referencecontent"></div>
        </div>




        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#main">Back</a></li>
                    <li><a href="#anylink" class="ui-disabled">Go</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Delete screens -->

    <div data-role="page" id="delete1">

        <div data-role="header" data-theme="a">
            <h1>Delete all data files?</h1>
        </div>

        <div data-role="content">
            <h2 style="padding-top:50px">Do you want to delete all of the data files found at:</h2>
            <h3 align="center">/storage/sdcard/alt/  ?</h3>
        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#administrator">Cancel deletion</a></li>
                    <li><a href="#delete2" data-theme="g">Yes, delete the data</a></li>
                </ul>
            </div>
        </div>


    </div>

    <div data-role="page" id="delete2">

        <div data-role="header" data-theme="a">
            <h1>Delete all user data?</h1>
        </div>

        <div data-role="content">
            <h2 style="padding-top:50px">Do you want to delete all of the data files found at:</h2>
            <h3 align="center">/storage/sdcard/alt/  ?</h3>
            <h2 style="padding-top:50px">This will delete all data including any zips, encrypted data, and decrypted data</h2>
        </div>

        <div data-role="footer" data-position="fixed">
            <div data-role="navbar">
                <ul>
                    <li><a href="#administrator">Cancel deletion</a></li>
                    <li><a href="#delete3" data-theme="g">Yes, delete the data</a></li>
                </ul>
            </div>
        </div>

    </div>

    <div data-role="page" id="delete3" data-theme="g">

        <div data-role="header" data-theme="g">
            <h1>Delete all user data?</h1>
        </div>

        <div data-role="content" data-theme="g">
            <h2 style="padding-top:20px">Do you want to delete all of the data files found at:</h2>
            <h3 align="center">/storage/sdcard/alt/  ?</h3>
            <h2 style="padding-top:30px">This will delete all data including any zips, encrypted data, and decrypted data</h2>
            <h1 align="center">Make certain you have grabbed the zipped data before deletion. Do you want to continue?</h1>
        </div>

        <div data-role="footer" data-position="fixed" data-theme="g">
            <div data-role="navbar">
                <ul>
                    <li><a href="#administrator" data-theme="a">Cancel deletion</a></li>
                    <li><a href="#administrator" onclick="deleteAllFiles()">Yes, delete the data</a></li>
                </ul>
            </div>
        </div>


    </div>

    <div data-role="page" id="wakeup" data-theme="f">

        <div data-role="header" data-theme="f">
            <h1>Wake up</h1>
        </div>

        <div data-role="content" data-theme="f">
            <h2 align="center">Would you like to wake up the application?</h2>
            <div data-role="controlgroup">
                <a href="#" data-role="button" onclick="wakeUp()" id="button-wakeup" >Wake up</a>
                <a href="#" data-role="button" onclick="snooze()" id="button-snooze">Snooze</a>
            </div>
        </div>


        <div data-role="footer" data-theme="f">
            <h4>UIC &amp; EVL</h4>
        </div>

    </div>


</body>
</html>
